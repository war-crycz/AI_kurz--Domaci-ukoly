{
  "data": {
    "edges": [
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "Prompt",
            "id": "Prompt-he4gj",
            "name": "prompt",
            "output_types": [
              "Message"
            ]
          },
          "targetHandle": {
            "fieldName": "system_message",
            "id": "LanguageModelComponent-i06VE",
            "inputTypes": [
              "Message"
            ],
            "type": "str"
          }
        },
        "id": "reactflow__edge-Prompt-he4gj{œdataTypeœ:œPromptœ,œidœ:œPrompt-he4gjœ,œnameœ:œpromptœ,œoutput_typesœ:[œMessageœ]}-LanguageModelComponent-i06VE{œfieldNameœ:œsystem_messageœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}",
        "selected": false,
        "source": "Prompt-he4gj",
        "sourceHandle": "{œdataTypeœ:œPromptœ,œidœ:œPrompt-he4gjœ,œnameœ:œpromptœ,œoutput_typesœ:[œMessageœ]}",
        "target": "LanguageModelComponent-i06VE",
        "targetHandle": "{œfieldNameœ:œsystem_messageœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}"
      },
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "ChatInput",
            "id": "ChatInput-R5WJa",
            "name": "message",
            "output_types": [
              "Message"
            ]
          },
          "targetHandle": {
            "fieldName": "input_value",
            "id": "LanguageModelComponent-i06VE",
            "inputTypes": [
              "Message"
            ],
            "type": "str"
          }
        },
        "id": "reactflow__edge-ChatInput-R5WJa{œdataTypeœ:œChatInputœ,œidœ:œChatInput-R5WJaœ,œnameœ:œmessageœ,œoutput_typesœ:[œMessageœ]}-LanguageModelComponent-i06VE{œfieldNameœ:œinput_valueœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}",
        "selected": false,
        "source": "ChatInput-R5WJa",
        "sourceHandle": "{œdataTypeœ:œChatInputœ,œidœ:œChatInput-R5WJaœ,œnameœ:œmessageœ,œoutput_typesœ:[œMessageœ]}",
        "target": "LanguageModelComponent-i06VE",
        "targetHandle": "{œfieldNameœ:œinput_valueœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}"
      },
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "LanguageModelComponent",
            "id": "LanguageModelComponent-i06VE",
            "name": "text_output",
            "output_types": [
              "Message"
            ]
          },
          "targetHandle": {
            "fieldName": "input_value",
            "id": "ChatOutput-hsBPM",
            "inputTypes": [
              "Data",
              "DataFrame",
              "Message"
            ],
            "type": "str"
          }
        },
        "id": "reactflow__edge-LanguageModelComponent-i06VE{œdataTypeœ:œLanguageModelComponentœ,œidœ:œLanguageModelComponent-i06VEœ,œnameœ:œtext_outputœ,œoutput_typesœ:[œMessageœ]}-ChatOutput-hsBPM{œfieldNameœ:œinput_valueœ,œidœ:œChatOutput-hsBPMœ,œinputTypesœ:[œDataœ,œDataFrameœ,œMessageœ],œtypeœ:œstrœ}",
        "selected": false,
        "source": "LanguageModelComponent-i06VE",
        "sourceHandle": "{œdataTypeœ:œLanguageModelComponentœ,œidœ:œLanguageModelComponent-i06VEœ,œnameœ:œtext_outputœ,œoutput_typesœ:[œMessageœ]}",
        "target": "ChatOutput-hsBPM",
        "targetHandle": "{œfieldNameœ:œinput_valueœ,œidœ:œChatOutput-hsBPMœ,œinputTypesœ:[œDataœ,œDataFrameœ,œMessageœ],œtypeœ:œstrœ}"
      },
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "CalculatorComponent",
            "id": "CustomComponent-R79V3",
            "name": "component_as_tool",
            "output_types": [
              "Tool"
            ]
          },
          "targetHandle": {
            "fieldName": "tools",
            "id": "LanguageModelComponent-i06VE",
            "inputTypes": [
              "Tool"
            ],
            "type": "other"
          }
        },
        "id": "xy-edge__CustomComponent-R79V3{œdataTypeœ:œCalculatorComponentœ,œidœ:œCustomComponent-R79V3œ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}-LanguageModelComponent-i06VE{œfieldNameœ:œtoolsœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}",
        "selected": false,
        "source": "CustomComponent-R79V3",
        "sourceHandle": "{œdataTypeœ:œCalculatorComponentœ,œidœ:œCustomComponent-R79V3œ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}",
        "target": "LanguageModelComponent-i06VE",
        "targetHandle": "{œfieldNameœ:œtoolsœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}"
      },
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "StockPriceComponent",
            "id": "CustomComponent-Q08ZY",
            "name": "component_as_tool",
            "output_types": [
              "Tool"
            ]
          },
          "targetHandle": {
            "fieldName": "tools",
            "id": "LanguageModelComponent-i06VE",
            "inputTypes": [
              "Tool"
            ],
            "type": "other"
          }
        },
        "id": "xy-edge__CustomComponent-Q08ZY{œdataTypeœ:œStockPriceComponentœ,œidœ:œCustomComponent-Q08ZYœ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}-LanguageModelComponent-i06VE{œfieldNameœ:œtoolsœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}",
        "selected": false,
        "source": "CustomComponent-Q08ZY",
        "sourceHandle": "{œdataTypeœ:œStockPriceComponentœ,œidœ:œCustomComponent-Q08ZYœ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}",
        "target": "LanguageModelComponent-i06VE",
        "targetHandle": "{œfieldNameœ:œtoolsœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}"
      },
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "CurrencyConverterComponent",
            "id": "CustomComponent-Hn5kB",
            "name": "component_as_tool",
            "output_types": [
              "Tool"
            ]
          },
          "targetHandle": {
            "fieldName": "tools",
            "id": "LanguageModelComponent-i06VE",
            "inputTypes": [
              "Tool"
            ],
            "type": "other"
          }
        },
        "id": "xy-edge__CustomComponent-Hn5kB{œdataTypeœ:œCurrencyConverterComponentœ,œidœ:œCustomComponent-Hn5kBœ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}-LanguageModelComponent-i06VE{œfieldNameœ:œtoolsœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}",
        "selected": false,
        "source": "CustomComponent-Hn5kB",
        "sourceHandle": "{œdataTypeœ:œCurrencyConverterComponentœ,œidœ:œCustomComponent-Hn5kBœ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}",
        "target": "LanguageModelComponent-i06VE",
        "targetHandle": "{œfieldNameœ:œtoolsœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}"
      },
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "WebScraperIDNESComponent",
            "id": "CustomComponent-J5Vsv",
            "name": "component_as_tool",
            "output_types": [
              "Tool"
            ]
          },
          "targetHandle": {
            "fieldName": "tools",
            "id": "LanguageModelComponent-i06VE",
            "inputTypes": [
              "Tool"
            ],
            "type": "other"
          }
        },
        "id": "xy-edge__CustomComponent-J5Vsv{œdataTypeœ:œWebScraperIDNESComponentœ,œidœ:œCustomComponent-J5Vsvœ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}-LanguageModelComponent-i06VE{œfieldNameœ:œtoolsœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}",
        "selected": false,
        "source": "CustomComponent-J5Vsv",
        "sourceHandle": "{œdataTypeœ:œWebScraperIDNESComponentœ,œidœ:œCustomComponent-J5Vsvœ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}",
        "target": "LanguageModelComponent-i06VE",
        "targetHandle": "{œfieldNameœ:œtoolsœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}"
      },
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "Memory",
            "id": "Memory-Itle7",
            "name": "messages_text",
            "output_types": [
              "Message"
            ]
          },
          "targetHandle": {
            "fieldName": "memory",
            "id": "Prompt-he4gj",
            "inputTypes": [
              "Message"
            ],
            "type": "str"
          }
        },
        "id": "xy-edge__Memory-Itle7{œdataTypeœ:œMemoryœ,œidœ:œMemory-Itle7œ,œnameœ:œmessages_textœ,œoutput_typesœ:[œMessageœ]}-Prompt-he4gj{œfieldNameœ:œmemoryœ,œidœ:œPrompt-he4gjœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}",
        "selected": false,
        "source": "Memory-Itle7",
        "sourceHandle": "{œdataTypeœ:œMemoryœ,œidœ:œMemory-Itle7œ,œnameœ:œmessages_textœ,œoutput_typesœ:[œMessageœ]}",
        "target": "Prompt-he4gj",
        "targetHandle": "{œfieldNameœ:œmemoryœ,œidœ:œPrompt-he4gjœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}"
      },
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "WeatherToolExtended",
            "id": "CustomComponent-23j76",
            "name": "api_build_tool",
            "output_types": [
              "Tool"
            ]
          },
          "targetHandle": {
            "fieldName": "tools",
            "id": "LanguageModelComponent-i06VE",
            "inputTypes": [
              "Tool"
            ],
            "type": "other"
          }
        },
        "id": "xy-edge__CustomComponent-23j76{œdataTypeœ:œWeatherToolExtendedœ,œidœ:œCustomComponent-23j76œ,œnameœ:œapi_build_toolœ,œoutput_typesœ:[œToolœ]}-LanguageModelComponent-i06VE{œfieldNameœ:œtoolsœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}",
        "selected": false,
        "source": "CustomComponent-23j76",
        "sourceHandle": "{œdataTypeœ:œWeatherToolExtendedœ,œidœ:œCustomComponent-23j76œ,œnameœ:œapi_build_toolœ,œoutput_typesœ:[œToolœ]}",
        "target": "LanguageModelComponent-i06VE",
        "targetHandle": "{œfieldNameœ:œtoolsœ,œidœ:œLanguageModelComponent-i06VEœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}"
      }
    ],
    "nodes": [
      {
        "data": {
          "id": "ChatInput-R5WJa",
          "node": {
            "base_classes": [
              "Message"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Get chat inputs from the Playground.",
            "display_name": "Chat Input",
            "documentation": "",
            "edited": false,
            "field_order": [
              "input_value",
              "should_store_message",
              "sender",
              "sender_name",
              "session_id",
              "files",
              "background_color",
              "chat_icon",
              "text_color"
            ],
            "frozen": false,
            "icon": "MessagesSquare",
            "legacy": false,
            "lf_version": "1.6.9",
            "metadata": {},
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Chat Message",
                "group_outputs": false,
                "method": "message_response",
                "name": "message",
                "selected": "Message",
                "tool_mode": true,
                "types": [
                  "Message"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_type": "Component",
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "from langflow.base.data.utils import IMG_FILE_TYPES, TEXT_FILE_TYPES\nfrom langflow.base.io.chat import ChatComponent\nfrom langflow.inputs.inputs import BoolInput\nfrom langflow.io import (\n    DropdownInput,\n    FileInput,\n    MessageTextInput,\n    MultilineInput,\n    Output,\n)\nfrom langflow.schema.message import Message\nfrom langflow.utils.constants import (\n    MESSAGE_SENDER_AI,\n    MESSAGE_SENDER_NAME_USER,\n    MESSAGE_SENDER_USER,\n)\n\n\nclass ChatInput(ChatComponent):\n    display_name = \"Chat Input\"\n    description = \"Get chat inputs from the Playground.\"\n    documentation: str = \"https://docs.langflow.org/components-io#chat-input\"\n    icon = \"MessagesSquare\"\n    name = \"ChatInput\"\n    minimized = True\n\n    inputs = [\n        MultilineInput(\n            name=\"input_value\",\n            display_name=\"Input Text\",\n            value=\"\",\n            info=\"Message to be passed as input.\",\n            input_types=[],\n        ),\n        BoolInput(\n            name=\"should_store_message\",\n            display_name=\"Store Messages\",\n            info=\"Store the message in the history.\",\n            value=True,\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"sender\",\n            display_name=\"Sender Type\",\n            options=[MESSAGE_SENDER_AI, MESSAGE_SENDER_USER],\n            value=MESSAGE_SENDER_USER,\n            info=\"Type of sender.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"sender_name\",\n            display_name=\"Sender Name\",\n            info=\"Name of the sender.\",\n            value=MESSAGE_SENDER_NAME_USER,\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"session_id\",\n            display_name=\"Session ID\",\n            info=\"The session ID of the chat. If empty, the current session ID parameter will be used.\",\n            advanced=True,\n        ),\n        FileInput(\n            name=\"files\",\n            display_name=\"Files\",\n            file_types=TEXT_FILE_TYPES + IMG_FILE_TYPES,\n            info=\"Files to be sent with the message.\",\n            advanced=True,\n            is_list=True,\n            temp_file=True,\n        ),\n    ]\n    outputs = [\n        Output(display_name=\"Chat Message\", name=\"message\", method=\"message_response\"),\n    ]\n\n    async def message_response(self) -> Message:\n        # Ensure files is a list and filter out empty/None values\n        files = self.files if self.files else []\n        if files and not isinstance(files, list):\n            files = [files]\n        files = [f for f in files if f is not None and f != \"\"]\n\n        message = await Message.create(\n            text=self.input_value,\n            sender=self.sender,\n            sender_name=self.sender_name,\n            session_id=self.session_id,\n            files=files,\n        )\n        if self.session_id and isinstance(message, Message) and self.should_store_message:\n            stored_message = await self.send_message(\n                message,\n            )\n            self.message.value = stored_message\n            message = stored_message\n\n        self.status = message\n        return message\n"
              },
              "files": {
                "_input_type": "FileInput",
                "advanced": true,
                "display_name": "Files",
                "dynamic": false,
                "fileTypes": [
                  "csv",
                  "json",
                  "pdf",
                  "txt",
                  "md",
                  "mdx",
                  "yaml",
                  "yml",
                  "xml",
                  "html",
                  "htm",
                  "docx",
                  "py",
                  "sh",
                  "sql",
                  "js",
                  "ts",
                  "tsx",
                  "jpg",
                  "jpeg",
                  "png",
                  "bmp",
                  "image"
                ],
                "file_path": "",
                "info": "Files to be sent with the message.",
                "list": true,
                "name": "files",
                "placeholder": "",
                "required": false,
                "show": true,
                "temp_file": true,
                "title_case": false,
                "trace_as_metadata": true,
                "type": "file",
                "value": ""
              },
              "input_value": {
                "_input_type": "MultilineInput",
                "advanced": false,
                "display_name": "Input Text",
                "dynamic": false,
                "info": "Message to be passed as input.",
                "input_types": [],
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "input_value",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": "Lukáši zeptej jaké je počasí, nebo jaká je cena akcí., nebo jaký je kurz USD"
              },
              "sender": {
                "_input_type": "DropdownInput",
                "advanced": true,
                "combobox": false,
                "display_name": "Sender Type",
                "dynamic": false,
                "info": "Type of sender.",
                "name": "sender",
                "options": [
                  "Machine",
                  "User"
                ],
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "str",
                "value": "User"
              },
              "sender_name": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Sender Name",
                "dynamic": false,
                "info": "Name of the sender.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "load_from_db": false,
                "name": "sender_name",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": "User"
              },
              "session_id": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Session ID",
                "dynamic": false,
                "info": "The session ID of the chat. If empty, the current session ID parameter will be used.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "load_from_db": false,
                "name": "session_id",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              },
              "should_store_message": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Store Messages",
                "dynamic": false,
                "info": "Store the message in the history.",
                "list": false,
                "name": "should_store_message",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "trace_as_metadata": true,
                "type": "bool",
                "value": true
              }
            },
            "tool_mode": false
          },
          "selected_output": "message",
          "type": "ChatInput"
        },
        "dragging": false,
        "height": 234,
        "id": "ChatInput-R5WJa",
        "measured": {
          "height": 234,
          "width": 320
        },
        "position": {
          "x": 1884.4719112881173,
          "y": 398.4841273527912
        },
        "positionAbsolute": {
          "x": 2321.5543981677606,
          "y": 374.0457826421628
        },
        "selected": false,
        "type": "genericNode",
        "width": 320
      },
      {
        "data": {
          "description": "Display a chat message in the Playground.",
          "display_name": "Chat Output",
          "id": "ChatOutput-hsBPM",
          "node": {
            "base_classes": [
              "Message"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Display a chat message in the Playground.",
            "display_name": "Chat Output",
            "documentation": "",
            "edited": false,
            "field_order": [
              "input_value",
              "should_store_message",
              "sender",
              "sender_name",
              "session_id",
              "data_template",
              "background_color",
              "chat_icon",
              "text_color"
            ],
            "frozen": false,
            "icon": "MessagesSquare",
            "legacy": false,
            "lf_version": "1.6.9",
            "metadata": {},
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Output Message",
                "group_outputs": false,
                "method": "message_response",
                "name": "message",
                "selected": "Message",
                "tool_mode": true,
                "types": [
                  "Message"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_type": "Component",
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "from collections.abc import Generator\nfrom typing import Any\n\nimport orjson\nfrom fastapi.encoders import jsonable_encoder\n\nfrom langflow.base.io.chat import ChatComponent\nfrom langflow.helpers.data import safe_convert\nfrom langflow.inputs.inputs import BoolInput, DropdownInput, HandleInput, MessageTextInput\nfrom langflow.schema.data import Data\nfrom langflow.schema.dataframe import DataFrame\nfrom langflow.schema.message import Message\nfrom langflow.schema.properties import Source\nfrom langflow.template.field.base import Output\nfrom langflow.utils.constants import (\n    MESSAGE_SENDER_AI,\n    MESSAGE_SENDER_NAME_AI,\n    MESSAGE_SENDER_USER,\n)\n\n\nclass ChatOutput(ChatComponent):\n    display_name = \"Chat Output\"\n    description = \"Display a chat message in the Playground.\"\n    documentation: str = \"https://docs.langflow.org/components-io#chat-output\"\n    icon = \"MessagesSquare\"\n    name = \"ChatOutput\"\n    minimized = True\n\n    inputs = [\n        HandleInput(\n            name=\"input_value\",\n            display_name=\"Inputs\",\n            info=\"Message to be passed as output.\",\n            input_types=[\"Data\", \"DataFrame\", \"Message\"],\n            required=True,\n        ),\n        BoolInput(\n            name=\"should_store_message\",\n            display_name=\"Store Messages\",\n            info=\"Store the message in the history.\",\n            value=True,\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"sender\",\n            display_name=\"Sender Type\",\n            options=[MESSAGE_SENDER_AI, MESSAGE_SENDER_USER],\n            value=MESSAGE_SENDER_AI,\n            advanced=True,\n            info=\"Type of sender.\",\n        ),\n        MessageTextInput(\n            name=\"sender_name\",\n            display_name=\"Sender Name\",\n            info=\"Name of the sender.\",\n            value=MESSAGE_SENDER_NAME_AI,\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"session_id\",\n            display_name=\"Session ID\",\n            info=\"The session ID of the chat. If empty, the current session ID parameter will be used.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"data_template\",\n            display_name=\"Data Template\",\n            value=\"{text}\",\n            advanced=True,\n            info=\"Template to convert Data to Text. If left empty, it will be dynamically set to the Data's text key.\",\n        ),\n    ]\n    outputs = [\n        Output(\n            display_name=\"Output Message\",\n            name=\"message\",\n            method=\"message_response\",\n        ),\n    ]\n\n    def _build_source(self, id_: str | None, display_name: str | None, source: str | None) -> Source:\n        source_dict = {}\n        if id_:\n            source_dict[\"id\"] = id_\n        if display_name:\n            source_dict[\"display_name\"] = display_name\n        if source:\n            # Handle case where source is a ChatOpenAI object\n            if hasattr(source, \"model_name\"):\n                source_dict[\"source\"] = source.model_name\n            elif hasattr(source, \"model\"):\n                source_dict[\"source\"] = str(source.model)\n            else:\n                source_dict[\"source\"] = str(source)\n        return Source(**source_dict)\n\n    async def message_response(self) -> Message:\n        # First convert the input to string if needed\n        text = self.convert_to_string()\n\n        # Get source properties\n        source, _icon, display_name, source_id = self.get_properties_from_source_component()\n\n        # Create or use existing Message object\n        if isinstance(self.input_value, Message):\n            message = self.input_value\n            # Update message properties\n            message.text = text\n        else:\n            message = Message(text=text)\n\n        # Set message properties\n        message.sender = self.sender\n        message.sender_name = self.sender_name\n        message.session_id = self.session_id\n        message.flow_id = self.graph.flow_id if hasattr(self, \"graph\") else None\n        message.properties.source = self._build_source(source_id, display_name, source)\n\n        # Store message if needed\n        if self.session_id and self.should_store_message:\n            stored_message = await self.send_message(message)\n            self.message.value = stored_message\n            message = stored_message\n\n        self.status = message\n        return message\n\n    def _serialize_data(self, data: Data) -> str:\n        \"\"\"Serialize Data object to JSON string.\"\"\"\n        # Convert data.data to JSON-serializable format\n        serializable_data = jsonable_encoder(data.data)\n        # Serialize with orjson, enabling pretty printing with indentation\n        json_bytes = orjson.dumps(serializable_data, option=orjson.OPT_INDENT_2)\n        # Convert bytes to string and wrap in Markdown code blocks\n        return \"```json\\n\" + json_bytes.decode(\"utf-8\") + \"\\n```\"\n\n    def _validate_input(self) -> None:\n        \"\"\"Validate the input data and raise ValueError if invalid.\"\"\"\n        if self.input_value is None:\n            msg = \"Input data cannot be None\"\n            raise ValueError(msg)\n        if isinstance(self.input_value, list) and not all(\n            isinstance(item, Message | Data | DataFrame | str) for item in self.input_value\n        ):\n            invalid_types = [\n                type(item).__name__\n                for item in self.input_value\n                if not isinstance(item, Message | Data | DataFrame | str)\n            ]\n            msg = f\"Expected Data or DataFrame or Message or str, got {invalid_types}\"\n            raise TypeError(msg)\n        if not isinstance(\n            self.input_value,\n            Message | Data | DataFrame | str | list | Generator | type(None),\n        ):\n            type_name = type(self.input_value).__name__\n            msg = f\"Expected Data or DataFrame or Message or str, Generator or None, got {type_name}\"\n            raise TypeError(msg)\n\n    def convert_to_string(self) -> str | Generator[Any, None, None]:\n        \"\"\"Convert input data to string with proper error handling.\"\"\"\n        self._validate_input()\n        if isinstance(self.input_value, list):\n            clean_data: bool = getattr(self, \"clean_data\", False)\n            return \"\\n\".join([safe_convert(item, clean_data=clean_data) for item in self.input_value])\n        if isinstance(self.input_value, Generator):\n            return self.input_value\n        return safe_convert(self.input_value)\n"
              },
              "data_template": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Data Template",
                "dynamic": false,
                "info": "Template to convert Data to Text. If left empty, it will be dynamically set to the Data's text key.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "load_from_db": false,
                "name": "data_template",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": "{text}"
              },
              "input_value": {
                "_input_type": "MessageInput",
                "advanced": false,
                "display_name": "Inputs",
                "dynamic": false,
                "info": "Message to be passed as output.",
                "input_types": [
                  "Data",
                  "DataFrame",
                  "Message"
                ],
                "list": false,
                "load_from_db": false,
                "name": "input_value",
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              },
              "sender": {
                "_input_type": "DropdownInput",
                "advanced": true,
                "combobox": false,
                "display_name": "Sender Type",
                "dynamic": false,
                "info": "Type of sender.",
                "name": "sender",
                "options": [
                  "Machine",
                  "User"
                ],
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "str",
                "value": "Machine"
              },
              "sender_name": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Sender Name",
                "dynamic": false,
                "info": "Name of the sender.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "load_from_db": false,
                "name": "sender_name",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": "AI"
              },
              "session_id": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Session ID",
                "dynamic": false,
                "info": "The session ID of the chat. If empty, the current session ID parameter will be used.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "load_from_db": false,
                "name": "session_id",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              },
              "should_store_message": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Store Messages",
                "dynamic": false,
                "info": "Store the message in the history.",
                "list": false,
                "name": "should_store_message",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "trace_as_metadata": true,
                "type": "bool",
                "value": true
              }
            },
            "tool_mode": false
          },
          "type": "ChatOutput"
        },
        "dragging": false,
        "height": 234,
        "id": "ChatOutput-hsBPM",
        "measured": {
          "height": 234,
          "width": 320
        },
        "position": {
          "x": 3200.6616109476727,
          "y": 763.9186776961858
        },
        "positionAbsolute": {
          "x": 3101.965731391458,
          "y": 776.4408905693839
        },
        "selected": false,
        "type": "genericNode",
        "width": 320
      },
      {
        "data": {
          "id": "Prompt-he4gj",
          "node": {
            "base_classes": [
              "Message"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {
              "template": [
                "memory"
              ]
            },
            "description": "Create a prompt template with dynamic variables.",
            "display_name": "Prompt",
            "documentation": "",
            "edited": false,
            "error": null,
            "field_order": [
              "template"
            ],
            "frozen": false,
            "full_path": null,
            "icon": "braces",
            "is_composition": null,
            "is_input": null,
            "is_output": null,
            "legacy": false,
            "lf_version": "1.6.9",
            "metadata": {
              "code_hash": "3bf0b511e227",
              "module": "langflow.components.prompts.prompt.PromptComponent"
            },
            "minimized": false,
            "name": "",
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Prompt",
                "group_outputs": false,
                "hidden": null,
                "method": "build_prompt",
                "name": "prompt",
                "options": null,
                "required_inputs": null,
                "selected": "Message",
                "tool_mode": true,
                "types": [
                  "Message"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "priority": null,
            "replacement": null,
            "template": {
              "_type": "Component",
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "from langflow.base.prompts.api_utils import process_prompt_template\nfrom langflow.custom.custom_component.component import Component\nfrom langflow.inputs.inputs import DefaultPromptField\nfrom langflow.io import MessageTextInput, Output, PromptInput\nfrom langflow.schema.message import Message\nfrom langflow.template.utils import update_template_values\n\n\nclass PromptComponent(Component):\n    display_name: str = \"Prompt\"\n    description: str = \"Create a prompt template with dynamic variables.\"\n    icon = \"braces\"\n    trace_type = \"prompt\"\n    name = \"Prompt\"\n\n    inputs = [\n        PromptInput(name=\"template\", display_name=\"Template\"),\n        MessageTextInput(\n            name=\"tool_placeholder\",\n            display_name=\"Tool Placeholder\",\n            tool_mode=True,\n            advanced=True,\n            info=\"A placeholder input for tool mode.\",\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"Prompt\", name=\"prompt\", method=\"build_prompt\"),\n    ]\n\n    async def build_prompt(self) -> Message:\n        prompt = Message.from_template(**self._attributes)\n        self.status = prompt.text\n        return prompt\n\n    def _update_template(self, frontend_node: dict):\n        prompt_template = frontend_node[\"template\"][\"template\"][\"value\"]\n        custom_fields = frontend_node[\"custom_fields\"]\n        frontend_node_template = frontend_node[\"template\"]\n        _ = process_prompt_template(\n            template=prompt_template,\n            name=\"template\",\n            custom_fields=custom_fields,\n            frontend_node_template=frontend_node_template,\n        )\n        return frontend_node\n\n    async def update_frontend_node(self, new_frontend_node: dict, current_frontend_node: dict):\n        \"\"\"This function is called after the code validation is done.\"\"\"\n        frontend_node = await super().update_frontend_node(new_frontend_node, current_frontend_node)\n        template = frontend_node[\"template\"][\"template\"][\"value\"]\n        # Kept it duplicated for backwards compatibility\n        _ = process_prompt_template(\n            template=template,\n            name=\"template\",\n            custom_fields=frontend_node[\"custom_fields\"],\n            frontend_node_template=frontend_node[\"template\"],\n        )\n        # Now that template is updated, we need to grab any values that were set in the current_frontend_node\n        # and update the frontend_node with those values\n        update_template_values(new_template=frontend_node, previous_template=current_frontend_node[\"template\"])\n        return frontend_node\n\n    def _get_fallback_input(self, **kwargs):\n        return DefaultPromptField(**kwargs)\n"
              },
              "memory": {
                "advanced": false,
                "display_name": "memory",
                "dynamic": false,
                "field_type": "str",
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "memory",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "type": "str",
                "value": ""
              },
              "template": {
                "_input_type": "PromptInput",
                "advanced": false,
                "display_name": "Template",
                "dynamic": false,
                "info": "",
                "list": false,
                "name": "template",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "type": "prompt",
                "value": "You are a helpful assistant with access to real-time tools for various data queries.\n\n## Available Tools\n\n### 1. Calculator\nUse for any mathematical calculations or arithmetic expressions.\n- Examples: \"What is 15 * 23?\", \"Calculate 1024 / 8\", \"What's the square root of 144?\"\n\n### 2. Currency Converter\nREQUIRED for all currency-related queries. Provides real-time exchange rates from ExchangeRate-API.com.\n- Use when: converting currencies, checking exchange rates, comparing currency values\n- Examples: \"What is 100 USD in CZK?\", \"Convert 50 EUR to USD\", \"Current exchange rate GBP to EUR\"\n- NEVER estimate or guess currency values - always use this tool\n\n### 3. Stock Price\nUse for current stock prices and basic stock information from Yahoo Finance.\n- Parameters: stock ticker symbol (e.g., AAPL, MSFT, GOOGL, TSLA)\n- Examples: \"What's the current price of Apple stock?\", \"TSLA stock price\", \"How is Microsoft doing?\"\n\n### 4. Weather Tool\nUse for current weather conditions and forecasts using Open-Meteo API.\n- Provides: temperature, wind speed, precipitation, and 3-day forecast\n- Examples: \"What's the weather in Prague?\", \"Weather forecast for London\", \"Is it raining in Berlin?\"\n\n### 5. Web Scraper iDNES\nUse for fetching current news articles from iDNES.cz (Czech news portal).\n- Extracts: article titles, links, published time, updated time\n- Examples: \"Show me latest news from iDNES\", \"What's happening in Czech news?\"\n\n## Response Guidelines\n1. Always use the appropriate tool for real-time data - never guess or estimate\n2. Present tool results clearly with source attribution\n3. Use markdown formatting for better readability\n4. For Czech users, respond in Czech when appropriate\n\nHistory: \n{memory}"
              },
              "tool_placeholder": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Tool Placeholder",
                "dynamic": false,
                "info": "A placeholder input for tool mode.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "load_from_db": false,
                "name": "tool_placeholder",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": true,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              }
            },
            "tool_mode": false
          },
          "selected_output": "prompt",
          "type": "Prompt"
        },
        "dragging": false,
        "height": 347,
        "id": "Prompt-he4gj",
        "measured": {
          "height": 347,
          "width": 320
        },
        "position": {
          "x": 2139.1839544266077,
          "y": 885.1231667526197
        },
        "positionAbsolute": {
          "x": 2327.422938009026,
          "y": 675.992123914672
        },
        "selected": true,
        "type": "genericNode",
        "width": 320
      },
      {
        "data": {
          "id": "Memory-Itle7",
          "node": {
            "base_classes": [
              "DataFrame"
            ],
            "beta": false,
            "category": "helpers",
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Stores or retrieves stored chat messages from Langflow tables or an external memory.",
            "display_name": "Message History",
            "documentation": "",
            "edited": false,
            "field_order": [
              "mode",
              "message",
              "memory",
              "sender",
              "sender_name",
              "n_messages",
              "session_id",
              "order",
              "template"
            ],
            "frozen": false,
            "icon": "message-square-more",
            "key": "Memory",
            "legacy": false,
            "lf_version": "1.6.9",
            "metadata": {},
            "minimized": false,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Message",
                "group_outputs": false,
                "method": "retrieve_messages_as_text",
                "name": "messages_text",
                "selected": "Message",
                "tool_mode": true,
                "types": [
                  "Message"
                ],
                "value": "__UNDEFINED__"
              },
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Dataframe",
                "group_outputs": false,
                "method": "retrieve_messages_dataframe",
                "name": "dataframe",
                "selected": null,
                "tool_mode": true,
                "types": [
                  "DataFrame"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "score": 0.007568328950209746,
            "template": {
              "_type": "Component",
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "from typing import Any, cast\n\nfrom langflow.custom.custom_component.component import Component\nfrom langflow.helpers.data import data_to_text\nfrom langflow.inputs.inputs import DropdownInput, HandleInput, IntInput, MessageTextInput, MultilineInput, TabInput\nfrom langflow.memory import aget_messages, astore_message\nfrom langflow.schema.data import Data\nfrom langflow.schema.dataframe import DataFrame\nfrom langflow.schema.dotdict import dotdict\nfrom langflow.schema.message import Message\nfrom langflow.template.field.base import Output\nfrom langflow.utils.component_utils import set_current_fields, set_field_display\nfrom langflow.utils.constants import MESSAGE_SENDER_AI, MESSAGE_SENDER_NAME_AI, MESSAGE_SENDER_USER\n\n\nclass MemoryComponent(Component):\n    display_name = \"Message History\"\n    description = \"Stores or retrieves stored chat messages from Langflow tables or an external memory.\"\n    documentation: str = \"https://docs.langflow.org/components-helpers#message-history\"\n    icon = \"message-square-more\"\n    name = \"Memory\"\n    default_keys = [\"mode\", \"memory\", \"session_id\"]\n    mode_config = {\n        \"Store\": [\"message\", \"memory\", \"sender\", \"sender_name\", \"session_id\"],\n        \"Retrieve\": [\"n_messages\", \"order\", \"template\", \"memory\", \"session_id\"],\n    }\n\n    inputs = [\n        TabInput(\n            name=\"mode\",\n            display_name=\"Mode\",\n            options=[\"Retrieve\", \"Store\"],\n            value=\"Retrieve\",\n            info=\"Operation mode: Store messages or Retrieve messages.\",\n            real_time_refresh=True,\n        ),\n        MessageTextInput(\n            name=\"message\",\n            display_name=\"Message\",\n            info=\"The chat message to be stored.\",\n            tool_mode=True,\n            dynamic=True,\n            show=False,\n        ),\n        HandleInput(\n            name=\"memory\",\n            display_name=\"External Memory\",\n            input_types=[\"Memory\"],\n            info=\"Retrieve messages from an external memory. If empty, it will use the Langflow tables.\",\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"sender_type\",\n            display_name=\"Sender Type\",\n            options=[MESSAGE_SENDER_AI, MESSAGE_SENDER_USER, \"Machine and User\"],\n            value=\"Machine and User\",\n            info=\"Filter by sender type.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"sender\",\n            display_name=\"Sender\",\n            info=\"The sender of the message. Might be Machine or User. \"\n            \"If empty, the current sender parameter will be used.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"sender_name\",\n            display_name=\"Sender Name\",\n            info=\"Filter by sender name.\",\n            advanced=True,\n            show=False,\n        ),\n        IntInput(\n            name=\"n_messages\",\n            display_name=\"Number of Messages\",\n            value=100,\n            info=\"Number of messages to retrieve.\",\n            advanced=True,\n            show=True,\n        ),\n        MessageTextInput(\n            name=\"session_id\",\n            display_name=\"Session ID\",\n            info=\"The session ID of the chat. If empty, the current session ID parameter will be used.\",\n            value=\"\",\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"order\",\n            display_name=\"Order\",\n            options=[\"Ascending\", \"Descending\"],\n            value=\"Ascending\",\n            info=\"Order of the messages.\",\n            advanced=True,\n            tool_mode=True,\n            required=True,\n        ),\n        MultilineInput(\n            name=\"template\",\n            display_name=\"Template\",\n            info=\"The template to use for formatting the data. \"\n            \"It can contain the keys {text}, {sender} or any other key in the message data.\",\n            value=\"{sender_name}: {text}\",\n            advanced=True,\n            show=False,\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"Message\", name=\"messages_text\", method=\"retrieve_messages_as_text\", dynamic=True),\n        Output(display_name=\"Dataframe\", name=\"dataframe\", method=\"retrieve_messages_dataframe\", dynamic=True),\n    ]\n\n    def update_outputs(self, frontend_node: dict, field_name: str, field_value: Any) -> dict:\n        \"\"\"Dynamically show only the relevant output based on the selected output type.\"\"\"\n        if field_name == \"mode\":\n            # Start with empty outputs\n            frontend_node[\"outputs\"] = []\n            if field_value == \"Store\":\n                frontend_node[\"outputs\"] = [\n                    Output(\n                        display_name=\"Stored Messages\",\n                        name=\"stored_messages\",\n                        method=\"store_message\",\n                        hidden=True,\n                        dynamic=True,\n                    )\n                ]\n            if field_value == \"Retrieve\":\n                frontend_node[\"outputs\"] = [\n                    Output(\n                        display_name=\"Messages\", name=\"messages_text\", method=\"retrieve_messages_as_text\", dynamic=True\n                    ),\n                    Output(\n                        display_name=\"Dataframe\", name=\"dataframe\", method=\"retrieve_messages_dataframe\", dynamic=True\n                    ),\n                ]\n        return frontend_node\n\n    async def store_message(self) -> Message:\n        message = Message(text=self.message) if isinstance(self.message, str) else self.message\n\n        message.session_id = self.session_id or message.session_id\n        message.sender = self.sender or message.sender or MESSAGE_SENDER_AI\n        message.sender_name = self.sender_name or message.sender_name or MESSAGE_SENDER_NAME_AI\n\n        stored_messages: list[Message] = []\n\n        if self.memory:\n            self.memory.session_id = message.session_id\n            lc_message = message.to_lc_message()\n            await self.memory.aadd_messages([lc_message])\n\n            stored_messages = await self.memory.aget_messages() or []\n\n            stored_messages = [Message.from_lc_message(m) for m in stored_messages] if stored_messages else []\n\n            if message.sender:\n                stored_messages = [m for m in stored_messages if m.sender == message.sender]\n        else:\n            await astore_message(message, flow_id=self.graph.flow_id)\n            stored_messages = (\n                await aget_messages(\n                    session_id=message.session_id, sender_name=message.sender_name, sender=message.sender\n                )\n                or []\n            )\n\n        if not stored_messages:\n            msg = \"No messages were stored. Please ensure that the session ID and sender are properly set.\"\n            raise ValueError(msg)\n\n        stored_message = stored_messages[0]\n        self.status = stored_message\n        return stored_message\n\n    async def retrieve_messages(self) -> Data:\n        sender_type = self.sender_type\n        sender_name = self.sender_name\n        session_id = self.session_id\n        n_messages = self.n_messages\n        order = \"DESC\" if self.order == \"Descending\" else \"ASC\"\n\n        if sender_type == \"Machine and User\":\n            sender_type = None\n\n        if self.memory and not hasattr(self.memory, \"aget_messages\"):\n            memory_name = type(self.memory).__name__\n            err_msg = f\"External Memory object ({memory_name}) must have 'aget_messages' method.\"\n            raise AttributeError(err_msg)\n        # Check if n_messages is None or 0\n        if n_messages == 0:\n            stored = []\n        elif self.memory:\n            # override session_id\n            self.memory.session_id = session_id\n\n            stored = await self.memory.aget_messages()\n            # langchain memories are supposed to return messages in ascending order\n\n            if n_messages:\n                stored = stored[-n_messages:]  # Get last N messages first\n\n            if order == \"DESC\":\n                stored = stored[::-1]  # Then reverse if needed\n\n            stored = [Message.from_lc_message(m) for m in stored]\n            if sender_type:\n                expected_type = MESSAGE_SENDER_AI if sender_type == MESSAGE_SENDER_AI else MESSAGE_SENDER_USER\n                stored = [m for m in stored if m.type == expected_type]\n        else:\n            # For internal memory, we always fetch the last N messages by ordering by DESC\n            stored = await aget_messages(\n                sender=sender_type,\n                sender_name=sender_name,\n                session_id=session_id,\n                limit=10000,\n                order=order,\n            )\n            if n_messages:\n                stored = stored[-n_messages:]  # Get last N messages\n\n        # self.status = stored\n        return cast(\"Data\", stored)\n\n    async def retrieve_messages_as_text(self) -> Message:\n        stored_text = data_to_text(self.template, await self.retrieve_messages())\n        # self.status = stored_text\n        return Message(text=stored_text)\n\n    async def retrieve_messages_dataframe(self) -> DataFrame:\n        \"\"\"Convert the retrieved messages into a DataFrame.\n\n        Returns:\n            DataFrame: A DataFrame containing the message data.\n        \"\"\"\n        messages = await self.retrieve_messages()\n        return DataFrame(messages)\n\n    def update_build_config(\n        self,\n        build_config: dotdict,\n        field_value: Any,  # noqa: ARG002\n        field_name: str | None = None,  # noqa: ARG002\n    ) -> dotdict:\n        return set_current_fields(\n            build_config=build_config,\n            action_fields=self.mode_config,\n            selected_action=build_config[\"mode\"][\"value\"],\n            default_fields=self.default_keys,\n            func=set_field_display,\n        )\n"
              },
              "memory": {
                "_input_type": "HandleInput",
                "advanced": true,
                "display_name": "External Memory",
                "dynamic": false,
                "info": "Retrieve messages from an external memory. If empty, it will use the Langflow tables.",
                "input_types": [
                  "Memory"
                ],
                "list": false,
                "list_add_label": "Add More",
                "name": "memory",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "trace_as_metadata": true,
                "type": "other",
                "value": ""
              },
              "message": {
                "_input_type": "MessageTextInput",
                "advanced": false,
                "display_name": "Message",
                "dynamic": true,
                "info": "The chat message to be stored.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "message",
                "placeholder": "",
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": true,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              },
              "mode": {
                "_input_type": "TabInput",
                "advanced": false,
                "display_name": "Mode",
                "dynamic": false,
                "info": "Operation mode: Store messages or Retrieve messages.",
                "name": "mode",
                "options": [
                  "Retrieve",
                  "Store"
                ],
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "tab",
                "value": "Retrieve"
              },
              "n_messages": {
                "_input_type": "IntInput",
                "advanced": true,
                "display_name": "Number of Messages",
                "dynamic": false,
                "info": "Number of messages to retrieve.",
                "list": false,
                "list_add_label": "Add More",
                "name": "n_messages",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "int",
                "value": 100
              },
              "order": {
                "_input_type": "DropdownInput",
                "advanced": true,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "Order",
                "dynamic": false,
                "info": "Order of the messages.",
                "name": "order",
                "options": [
                  "Ascending",
                  "Descending"
                ],
                "options_metadata": [],
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "toggle": false,
                "tool_mode": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": "Ascending"
              },
              "sender": {
                "_input_type": "DropdownInput",
                "advanced": true,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "Sender",
                "dynamic": false,
                "info": "The sender of the message. Might be Machine or User. If empty, the current sender parameter will be used.",
                "name": "sender",
                "options": [
                  "Machine",
                  "User",
                  "Machine and User"
                ],
                "options_metadata": [],
                "placeholder": "",
                "required": false,
                "show": false,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "str",
                "value": "Machine and User"
              },
              "sender_name": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Sender Name",
                "dynamic": false,
                "info": "Filter by sender name.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "sender_name",
                "placeholder": "",
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              },
              "sender_type": {
                "_input_type": "DropdownInput",
                "advanced": true,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "Sender Type",
                "dynamic": false,
                "info": "Filter by sender type.",
                "name": "sender_type",
                "options": [
                  "Machine",
                  "User",
                  "Machine and User"
                ],
                "options_metadata": [],
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "str",
                "value": "Machine and User"
              },
              "session_id": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Session ID",
                "dynamic": false,
                "info": "The session ID of the chat. If empty, the current session ID parameter will be used.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "session_id",
                "placeholder": "",
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              },
              "template": {
                "_input_type": "MultilineInput",
                "advanced": true,
                "copy_field": false,
                "display_name": "Template",
                "dynamic": false,
                "info": "The template to use for formatting the data. It can contain the keys {text}, {sender} or any other key in the message data.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "multiline": true,
                "name": "template",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": "{sender_name}: {text}"
              }
            },
            "tool_mode": false
          },
          "selected_output": "messages_text",
          "showNode": true,
          "type": "Memory"
        },
        "dragging": false,
        "id": "Memory-Itle7",
        "measured": {
          "height": 217,
          "width": 320
        },
        "position": {
          "x": 1699.8915239826588,
          "y": 985.2464871079995
        },
        "selected": false,
        "type": "genericNode"
      },
      {
        "data": {
          "id": "LanguageModelComponent-i06VE",
          "node": {
            "base_classes": [
              "LanguageModel",
              "Message"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Runs a language model given a specified provider.",
            "display_name": "Language Model",
            "documentation": "https://docs.langflow.org/components-models",
            "edited": true,
            "field_order": [
              "provider",
              "model_name",
              "api_key",
              "input_value",
              "system_message",
              "tools",
              "stream",
              "temperature"
            ],
            "frozen": false,
            "icon": "brain-circuit",
            "last_updated": "2025-12-02T07:03:28.360Z",
            "legacy": false,
            "lf_version": "1.6.9",
            "metadata": {
              "keywords": [
                "model",
                "llm",
                "language model",
                "large language model"
              ]
            },
            "minimized": false,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Model Response",
                "group_outputs": false,
                "hidden": null,
                "method": "text_response",
                "name": "text_output",
                "options": null,
                "required_inputs": null,
                "selected": "Message",
                "tool_mode": true,
                "types": [
                  "Message"
                ],
                "value": "__UNDEFINED__"
              },
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Language Model",
                "group_outputs": false,
                "hidden": null,
                "method": "build_model",
                "name": "model_output",
                "options": null,
                "required_inputs": null,
                "selected": "LanguageModel",
                "tool_mode": true,
                "types": [
                  "LanguageModel"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "priority": 0,
            "template": {
              "_type": "Component",
              "api_key": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "OpenAI API Key",
                "dynamic": false,
                "info": "Model Provider API key",
                "input_types": [],
                "load_from_db": true,
                "name": "api_key",
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "type": "str",
                "value": ""
              },
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "from typing import Any\r\n\r\nfrom langchain_anthropic import ChatAnthropic\r\nfrom langchain_google_genai import ChatGoogleGenerativeAI\r\nfrom langchain_openai import ChatOpenAI\r\n\r\nfrom langflow.base.models.anthropic_constants import ANTHROPIC_MODELS\r\nfrom langflow.base.models.google_generative_ai_constants import GOOGLE_GENERATIVE_AI_MODELS\r\nfrom langflow.base.models.model import LCModelComponent\r\nfrom langflow.base.models.openai_constants import OPENAI_CHAT_MODEL_NAMES, OPENAI_REASONING_MODEL_NAMES\r\nfrom langflow.field_typing import LanguageModel\r\nfrom langflow.field_typing.range_spec import RangeSpec\r\nfrom langflow.inputs.inputs import BoolInput, HandleInput\r\nfrom langflow.io import DropdownInput, MessageInput, MultilineInput, SecretStrInput, SliderInput\r\nfrom langflow.schema.dotdict import dotdict\r\nfrom langflow.schema.message import Message\r\n\r\n\r\nclass LanguageModelComponent(LCModelComponent):\r\n    display_name = \"Language Model\"\r\n    description = \"Runs a language model given a specified provider.\"\r\n    documentation: str = \"https://docs.langflow.org/components-models\"\r\n    icon = \"brain-circuit\"\r\n    category = \"models\"\r\n    priority = 0  # Set priority to 0 to make it appear first\r\n\r\n    inputs = [\r\n        DropdownInput(\r\n            name=\"provider\",\r\n            display_name=\"Model Provider\",\r\n            options=[\"OpenAI\", \"Anthropic\", \"Google\"],\r\n            value=\"OpenAI\",\r\n            info=\"Select the model provider\",\r\n            real_time_refresh=True,\r\n            options_metadata=[{\"icon\": \"OpenAI\"}, {\"icon\": \"Anthropic\"}, {\"icon\": \"GoogleGenerativeAI\"}],\r\n        ),\r\n        DropdownInput(\r\n            name=\"model_name\",\r\n            display_name=\"Model Name\",\r\n            options=OPENAI_CHAT_MODEL_NAMES + OPENAI_REASONING_MODEL_NAMES,\r\n            value=OPENAI_CHAT_MODEL_NAMES[0],\r\n            info=\"Select the model to use\",\r\n            real_time_refresh=True,\r\n        ),\r\n        SecretStrInput(\r\n            name=\"api_key\",\r\n            display_name=\"OpenAI API Key\",\r\n            info=\"Model Provider API key\",\r\n            required=False,\r\n            show=True,\r\n            real_time_refresh=True,\r\n        ),\r\n        MessageInput(\r\n            name=\"input_value\",\r\n            display_name=\"Input\",\r\n            info=\"The input text to send to the model\",\r\n        ),\r\n        MultilineInput(\r\n            name=\"system_message\",\r\n            display_name=\"System Message\",\r\n            info=\"A system message that helps set the behavior of the assistant\",\r\n            advanced=False,\r\n        ),\r\n        HandleInput(\r\n            name=\"tools\",\r\n            display_name=\"Tools\",\r\n            input_types=[\"Tool\"],\r\n            is_list=True,\r\n            info=\"Tools to bind to the model\",\r\n        ),\r\n        BoolInput(\r\n            name=\"stream\",\r\n            display_name=\"Stream\",\r\n            info=\"Whether to stream the response\",\r\n            value=False,\r\n            advanced=True,\r\n        ),\r\n        SliderInput(\r\n            name=\"temperature\",\r\n            display_name=\"Temperature\",\r\n            value=0.1,\r\n            info=\"Controls randomness in responses\",\r\n            range_spec=RangeSpec(min=0, max=1, step=0.01),\r\n            advanced=True,\r\n        ),\r\n    ]\r\n\r\n    def build_model(self) -> LanguageModel:\r\n        provider = self.provider\r\n        model_name = self.model_name\r\n        temperature = self.temperature\r\n        stream = self.stream\r\n        model = None\r\n\r\n        if provider == \"OpenAI\":\r\n            if not self.api_key:\r\n                msg = \"OpenAI API key is required when using OpenAI provider\"\r\n                raise ValueError(msg)\r\n\r\n            if model_name in OPENAI_REASONING_MODEL_NAMES:\r\n                # reasoning models do not support temperature (yet)\r\n                temperature = None\r\n\r\n            model = ChatOpenAI(\r\n                model_name=model_name,\r\n                temperature=temperature,\r\n                streaming=stream,\r\n                openai_api_key=self.api_key,\r\n            )\r\n        elif provider == \"Anthropic\":\r\n            if not self.api_key:\r\n                msg = \"Anthropic API key is required when using Anthropic provider\"\r\n                raise ValueError(msg)\r\n            model = ChatAnthropic(\r\n                model=model_name,\r\n                temperature=temperature,\r\n                streaming=stream,\r\n                anthropic_api_key=self.api_key,\r\n            )\r\n        elif provider == \"Google\":\r\n            if not self.api_key:\r\n                msg = \"Google API key is required when using Google provider\"\r\n                raise ValueError(msg)\r\n            model = ChatGoogleGenerativeAI(\r\n                model=model_name,\r\n                temperature=temperature,\r\n                streaming=stream,\r\n                google_api_key=self.api_key,\r\n            )\r\n        else:\r\n            msg = f\"Unknown provider: {provider}\"\r\n            raise ValueError(msg)\r\n\r\n        if hasattr(self, \"tools\") and self.tools:\r\n            # Bind tools to the model if provided\r\n            model = model.bind_tools(self.tools)\r\n            \r\n        return model\r\n\r\n    def text_response(self) -> Message:\r\n        \"\"\"\r\n        Executes the model and returns the response as a Message.\r\n        If tools are provided, it uses an AgentExecutor to handle tool calls.\r\n        \"\"\"\r\n        try:\r\n            model = self.build_model()\r\n            \r\n            if hasattr(self, \"tools\") and self.tools:\r\n                # If tools are present, run as an Agent\r\n                from langchain.agents import AgentExecutor, create_tool_calling_agent\r\n                from langchain_core.prompts import ChatPromptTemplate\r\n                \r\n                # Create a prompt for the agent\r\n                system = self.system_message or \"You are a helpful assistant.\"\r\n                prompt = ChatPromptTemplate.from_messages([\r\n                    (\"system\", system),\r\n                    (\"placeholder\", \"{chat_history}\"),\r\n                    (\"human\", \"{input}\"),\r\n                    (\"placeholder\", \"{agent_scratchpad}\"),\r\n                ])\r\n                \r\n                agent = create_tool_calling_agent(model, self.tools, prompt)\r\n                executor = AgentExecutor(agent=agent, tools=self.tools, verbose=True)\r\n                \r\n                # Execute the agent\r\n                result = executor.invoke({\"input\": self.input_value, \"chat_history\": []})\r\n                output_text = result[\"output\"]\r\n                \r\n                return Message(text=output_text)\r\n            else:\r\n                # If no tools, run as a standard model\r\n                # We need to construct the messages manually since we are bypassing the base class logic if we override\r\n                from langchain_core.messages import HumanMessage, SystemMessage\r\n                \r\n                messages = []\r\n                if self.system_message:\r\n                    messages.append(SystemMessage(content=self.system_message))\r\n                messages.append(HumanMessage(content=self.input_value))\r\n                \r\n                response = model.invoke(messages)\r\n                content = response.content\r\n                return Message(text=str(content))\r\n\r\n        except Exception as e:\r\n            return Message(text=f\"Error running model: {str(e)}\")\r\n\r\n    def update_build_config(self, build_config: dotdict, field_value: Any, field_name: str | None = None) -> dotdict:\r\n        if field_name == \"provider\":\r\n            if field_value == \"OpenAI\":\r\n                build_config[\"model_name\"][\"options\"] = OPENAI_CHAT_MODEL_NAMES + OPENAI_REASONING_MODEL_NAMES\r\n                build_config[\"model_name\"][\"value\"] = OPENAI_CHAT_MODEL_NAMES[0]\r\n                build_config[\"api_key\"][\"display_name\"] = \"OpenAI API Key\"\r\n            elif field_value == \"Anthropic\":\r\n                build_config[\"model_name\"][\"options\"] = ANTHROPIC_MODELS\r\n                build_config[\"model_name\"][\"value\"] = ANTHROPIC_MODELS[0]\r\n                build_config[\"api_key\"][\"display_name\"] = \"Anthropic API Key\"\r\n            elif field_value == \"Google\":\r\n                build_config[\"model_name\"][\"options\"] = GOOGLE_GENERATIVE_AI_MODELS\r\n                build_config[\"model_name\"][\"value\"] = GOOGLE_GENERATIVE_AI_MODELS[0]\r\n                build_config[\"api_key\"][\"display_name\"] = \"Google API Key\"\r\n        elif field_name == \"model_name\" and field_value.startswith(\"o1\") and self.provider == \"OpenAI\":\r\n            # Hide system_message for o1 models - currently unsupported\r\n            if \"system_message\" in build_config:\r\n                build_config[\"system_message\"][\"show\"] = False\r\n        elif field_name == \"model_name\" and not field_value.startswith(\"o1\") and \"system_message\" in build_config:\r\n            build_config[\"system_message\"][\"show\"] = True\r\n        return build_config\r\n"
              },
              "input_value": {
                "_input_type": "MessageInput",
                "advanced": false,
                "display_name": "Input",
                "dynamic": false,
                "info": "The input text to send to the model",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "input_value",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              },
              "model_name": {
                "_input_type": "DropdownInput",
                "advanced": false,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "Model Name",
                "dynamic": false,
                "external_options": {},
                "info": "Select the model to use",
                "load_from_db": false,
                "name": "model_name",
                "options": [
                  "gpt-4o-mini",
                  "gpt-4o",
                  "gpt-4.1",
                  "gpt-4.1-mini",
                  "gpt-4.1-nano",
                  "gpt-4-turbo",
                  "gpt-4-turbo-preview",
                  "gpt-4",
                  "gpt-3.5-turbo",
                  "gpt-5",
                  "gpt-5-mini",
                  "gpt-5-nano",
                  "gpt-5-chat-latest",
                  "o1",
                  "o3-mini",
                  "o3",
                  "o3-pro",
                  "o4-mini",
                  "o4-mini-high"
                ],
                "options_metadata": [],
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "str",
                "value": "gpt-4.1"
              },
              "provider": {
                "_input_type": "DropdownInput",
                "advanced": false,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "Model Provider",
                "dynamic": false,
                "external_options": {},
                "info": "Select the model provider",
                "name": "provider",
                "options": [
                  "OpenAI",
                  "Anthropic",
                  "Google"
                ],
                "options_metadata": [
                  {
                    "icon": "OpenAI"
                  },
                  {
                    "icon": "Anthropic"
                  },
                  {
                    "icon": "GoogleGenerativeAI"
                  }
                ],
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "str",
                "value": "OpenAI"
              },
              "stream": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Stream",
                "dynamic": false,
                "info": "Whether to stream the response",
                "list": false,
                "list_add_label": "Add More",
                "name": "stream",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "bool",
                "value": false
              },
              "system_message": {
                "_input_type": "MultilineInput",
                "advanced": false,
                "copy_field": false,
                "display_name": "System Message",
                "dynamic": false,
                "info": "A system message that helps set the behavior of the assistant",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "multiline": true,
                "name": "system_message",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              },
              "temperature": {
                "_input_type": "SliderInput",
                "advanced": true,
                "display_name": "Temperature",
                "dynamic": false,
                "info": "Controls randomness in responses",
                "max_label": "",
                "max_label_icon": "",
                "min_label": "",
                "min_label_icon": "",
                "name": "temperature",
                "placeholder": "",
                "range_spec": {
                  "max": 1,
                  "min": 0,
                  "step": 0.01,
                  "step_type": "float"
                },
                "required": false,
                "show": true,
                "slider_buttons": false,
                "slider_buttons_options": [],
                "slider_input": false,
                "title_case": false,
                "tool_mode": false,
                "type": "slider",
                "value": 0.1
              },
              "tools": {
                "_input_type": "HandleInput",
                "advanced": false,
                "display_name": "Tools",
                "dynamic": false,
                "info": "Tools to bind to the model",
                "input_types": [
                  "Tool"
                ],
                "list": true,
                "list_add_label": "Add More",
                "name": "tools",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "trace_as_metadata": true,
                "type": "other",
                "value": ""
              }
            },
            "tool_mode": false
          },
          "selected_output": "text_output",
          "showNode": true,
          "type": "LanguageModelComponent"
        },
        "dragging": false,
        "id": "LanguageModelComponent-i06VE",
        "measured": {
          "height": 578,
          "width": 320
        },
        "position": {
          "x": 2726.7653522717746,
          "y": 453.1927474431865
        },
        "selected": false,
        "type": "genericNode"
      },
      {
        "data": {
          "id": "CustomComponent-23j76",
          "node": {
            "base_classes": [
              "Data",
              "DataFrame",
              "Tool"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Get current weather, precipitation, and forecast for a specific city using Open-Meteo API. Includes source attribution.",
            "display_name": "Weather Tool (Extended)",
            "documentation": "",
            "edited": true,
            "field_order": [
              "input_value"
            ],
            "frozen": false,
            "icon": "cloud-rain",
            "legacy": false,
            "lf_version": "1.6.9",
            "metadata": {},
            "minimized": false,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Data",
                "group_outputs": false,
                "hidden": null,
                "method": "run_model",
                "name": "api_run_model",
                "options": null,
                "required_inputs": null,
                "selected": "DataFrame",
                "tool_mode": true,
                "types": [
                  "DataFrame",
                  "Data"
                ],
                "value": "__UNDEFINED__"
              },
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Tool",
                "group_outputs": false,
                "hidden": null,
                "method": "build_tool",
                "name": "api_build_tool",
                "options": null,
                "required_inputs": null,
                "selected": "Tool",
                "tool_mode": true,
                "types": [
                  "Tool"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_type": "Component",
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "from typing import Any, List\r\n\r\nimport requests\r\nfrom langchain.tools import StructuredTool\r\nfrom pydantic import BaseModel, Field\r\n\r\nfrom langflow.base.langchain_utilities.model import LCToolComponent\r\nfrom langflow.field_typing import Tool\r\nfrom langflow.inputs import MessageInput\r\n\r\n\r\nclass WeatherExtendedToolComponent(LCToolComponent):\r\n    display_name = \"Weather Tool (Extended)\"\r\n    description = \"Get current weather, precipitation, and forecast for a specific city using Open-Meteo API. Includes source attribution.\"\r\n    icon = \"cloud-rain\"\r\n    name = \"WeatherToolExtended\"\r\n\r\n    inputs = [\r\n        MessageInput(\r\n            name=\"input_value\",\r\n            display_name=\"Input\",\r\n            info=\"Input message (not used directly by the tool logic but required by component structure)\",\r\n        ),\r\n    ]\r\n\r\n    def build_tool(self) -> Tool:\r\n        class WeatherInput(BaseModel):\r\n            city: str = Field(description=\"The name of the city to get weather for, e.g. 'London', 'Prague'\")\r\n\r\n        def get_weather_forecast(city: str) -> str:\r\n            \"\"\"Get the current weather, precipitation, and 3-day forecast for a given city.\"\"\"\r\n            try:\r\n                # 1. Geocoding to get lat/lon\r\n                geo_url = f\"https://geocoding-api.open-meteo.com/v1/search?name={city}&count=1&language=en&format=json\"\r\n                geo_response = requests.get(geo_url)\r\n                geo_data = geo_response.json()\r\n\r\n                if not geo_data.get(\"results\"):\r\n                    return f\"Error: City '{city}' not found.\"\r\n\r\n                location = geo_data[\"results\"][0]\r\n                lat = location[\"latitude\"]\r\n                lon = location[\"longitude\"]\r\n                name = location[\"name\"]\r\n                country = location.get(\"country\", \"\")\r\n\r\n                # 2. Weather data (Current + Daily Forecast)\r\n                # Added precipitation to current and daily\r\n                weather_url = (\r\n                    f\"https://api.open-meteo.com/v1/forecast?\"\r\n                    f\"latitude={lat}&longitude={lon}&\"\r\n                    f\"current=temperature_2m,wind_speed_10m,precipitation&\"\r\n                    f\"daily=temperature_2m_max,temperature_2m_min,precipitation_sum&\"\r\n                    f\"wind_speed_unit=ms&timezone=auto&forecast_days=4\"\r\n                )\r\n                weather_response = requests.get(weather_url)\r\n                weather_data = weather_response.json()\r\n\r\n                if \"current\" not in weather_data or \"daily\" not in weather_data:\r\n                    return f\"Error: Could not retrieve weather data for {name}.\"\r\n\r\n                # Current Weather\r\n                current = weather_data[\"current\"]\r\n                temp = current[\"temperature_2m\"]\r\n                wind = current[\"wind_speed_10m\"]\r\n                precip = current.get(\"precipitation\", 0.0)\r\n                \r\n                output = f\"Weather in {name}, {country}:\\n\"\r\n                output += f\"Current: {temp}°C, Wind: {wind} m/s, Precipitation: {precip} mm.\\n\"\r\n                \r\n                # Forecast\r\n                daily = weather_data[\"daily\"]\r\n                times = daily[\"time\"]\r\n                max_temps = daily[\"temperature_2m_max\"]\r\n                min_temps = daily[\"temperature_2m_min\"]\r\n                precip_sums = daily.get(\"precipitation_sum\", [0.0]*len(times))\r\n                \r\n                output += \"Forecast:\\n\"\r\n                # Skip index 0 as it is often today, or include it. Let's include next 3 days.\r\n                for i in range(len(times)):\r\n                    date = times[i]\r\n                    max_t = max_temps[i]\r\n                    min_t = min_temps[i]\r\n                    p_sum = precip_sums[i]\r\n                    output += f\"- {date}: Max {max_t}°C, Min {min_t}°C, Rain {p_sum} mm\\n\"\r\n                \r\n                # Source Attribution\r\n                output += f\"Source: Open-Meteo\\n\"\r\n                output += f\"API: {weather_url}\"\r\n\r\n                return output\r\n\r\n            except Exception as e:\r\n                return f\"Error fetching weather: {str(e)}\"\r\n\r\n        return StructuredTool.from_function(\r\n            func=get_weather_forecast,\r\n            name=\"get_weather_forecast\",\r\n            description=\"Useful for getting current weather, precipitation, and forecast for a specific city.\",\r\n            args_schema=WeatherInput,\r\n        )\r\n"
              },
              "input_value": {
                "_input_type": "MessageInput",
                "advanced": false,
                "display_name": "Input",
                "dynamic": false,
                "info": "Input message (not used directly by the tool logic but required by component structure)",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "input_value",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": "Jaké je počasí  v Brně? "
              }
            },
            "tool_mode": false
          },
          "selected_output": "api_build_tool",
          "showNode": true,
          "type": "WeatherToolExtended"
        },
        "dragging": false,
        "id": "CustomComponent-23j76",
        "measured": {
          "height": 235,
          "width": 320
        },
        "position": {
          "x": 1882.3523619261532,
          "y": -109.65220387379858
        },
        "selected": false,
        "type": "genericNode"
      },
      {
        "data": {
          "id": "CustomComponent-R79V3",
          "node": {
            "base_classes": [
              "Data"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Perform basic arithmetic operations on a given expression.",
            "display_name": "Calculator",
            "documentation": "https://docs.langflow.org/components-helpers#calculator",
            "edited": true,
            "field_order": [
              "expression"
            ],
            "frozen": false,
            "icon": "calculator",
            "last_updated": "2025-12-02T07:03:28.362Z",
            "legacy": false,
            "lf_version": "1.6.9",
            "metadata": {},
            "minimized": false,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Toolset",
                "group_outputs": false,
                "hidden": null,
                "method": "to_toolkit",
                "name": "component_as_tool",
                "options": null,
                "required_inputs": null,
                "selected": "Tool",
                "tool_mode": true,
                "types": [
                  "Tool"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_type": "Component",
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "import ast\nimport operator\nfrom collections.abc import Callable\n\nfrom langflow.custom.custom_component.component import Component\nfrom langflow.inputs.inputs import MessageTextInput\nfrom langflow.io import Output\nfrom langflow.schema.data import Data\n\n\nclass CalculatorComponent(Component):\n    display_name = \"Calculator\"\n    description = \"Perform basic arithmetic operations on a given expression.\"\n    documentation: str = \"https://docs.langflow.org/components-helpers#calculator\"\n    icon = \"calculator\"\n\n    # Cache operators dictionary as a class variable\n    OPERATORS: dict[type[ast.operator], Callable] = {\n        ast.Add: operator.add,\n        ast.Sub: operator.sub,\n        ast.Mult: operator.mul,\n        ast.Div: operator.truediv,\n        ast.Pow: operator.pow,\n    }\n\n    inputs = [\n        MessageTextInput(\n            name=\"expression\",\n            display_name=\"Expression\",\n            info=\"The arithmetic expression to evaluate (e.g., '4*4*(33/22)+12-20').\",\n            tool_mode=True,\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"Data\", name=\"result\", type_=Data, method=\"evaluate_expression\"),\n    ]\n\n    def _eval_expr(self, node: ast.AST) -> float:\n        \"\"\"Evaluate an AST node recursively.\"\"\"\n        if isinstance(node, ast.Constant):\n            if isinstance(node.value, int | float):\n                return float(node.value)\n            error_msg = f\"Unsupported constant type: {type(node.value).__name__}\"\n            raise TypeError(error_msg)\n        if isinstance(node, ast.Num):  # For backwards compatibility\n            if isinstance(node.n, int | float):\n                return float(node.n)\n            error_msg = f\"Unsupported number type: {type(node.n).__name__}\"\n            raise TypeError(error_msg)\n\n        if isinstance(node, ast.BinOp):\n            op_type = type(node.op)\n            if op_type not in self.OPERATORS:\n                error_msg = f\"Unsupported binary operator: {op_type.__name__}\"\n                raise TypeError(error_msg)\n\n            left = self._eval_expr(node.left)\n            right = self._eval_expr(node.right)\n            return self.OPERATORS[op_type](left, right)\n\n        error_msg = f\"Unsupported operation or expression type: {type(node).__name__}\"\n        raise TypeError(error_msg)\n\n    def evaluate_expression(self) -> Data:\n        \"\"\"Evaluate the mathematical expression and return the result.\"\"\"\n        try:\n            tree = ast.parse(self.expression, mode=\"eval\")\n            result = self._eval_expr(tree.body)\n\n            formatted_result = f\"{float(result):.6f}\".rstrip(\"0\").rstrip(\".\")\n            self.log(f\"Calculation result: {formatted_result}\")\n\n            self.status = formatted_result\n            return Data(data={\"result\": formatted_result})\n\n        except ZeroDivisionError:\n            error_message = \"Error: Division by zero\"\n            self.status = error_message\n            return Data(data={\"error\": error_message, \"input\": self.expression})\n\n        except (SyntaxError, TypeError, KeyError, ValueError, AttributeError, OverflowError) as e:\n            error_message = f\"Invalid expression: {e!s}\"\n            self.status = error_message\n            return Data(data={\"error\": error_message, \"input\": self.expression})\n\n    def build(self):\n        \"\"\"Return the main evaluation function.\"\"\"\n        return self.evaluate_expression\n"
              },
              "expression": {
                "_input_type": "MessageTextInput",
                "advanced": false,
                "display_name": "Expression",
                "dynamic": false,
                "info": "The arithmetic expression to evaluate (e.g., '4*4*(33/22)+12-20').",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "expression",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": true,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              },
              "tools_metadata": {
                "_input_type": "ToolsInput",
                "advanced": false,
                "display_name": "Actions",
                "dynamic": false,
                "info": "Modify tool names and descriptions to help agents understand when to use each tool.",
                "is_list": true,
                "list_add_label": "Add More",
                "name": "tools_metadata",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "tools",
                "value": [
                  {
                    "args": {
                      "expression": {
                        "default": "",
                        "description": "The arithmetic expression to evaluate (e.g., '4*4*(33/22)+12-20').",
                        "title": "Expression",
                        "type": "string"
                      }
                    },
                    "description": "Perform basic arithmetic operations on a given expression.",
                    "display_description": "Perform basic arithmetic operations on a given expression.",
                    "display_name": "evaluate_expression",
                    "name": "evaluate_expression",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "evaluate_expression"
                    ]
                  }
                ]
              }
            },
            "tool_mode": true
          },
          "showNode": true,
          "type": "CalculatorComponent"
        },
        "dragging": false,
        "id": "CustomComponent-R79V3",
        "measured": {
          "height": 217,
          "width": 320
        },
        "position": {
          "x": 1881.1458016428478,
          "y": 133.720239347449
        },
        "selected": false,
        "type": "genericNode"
      },
      {
        "data": {
          "id": "CustomComponent-Q08ZY",
          "node": {
            "base_classes": [
              "Data"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Get current stock price and basic information using Yahoo Finance.",
            "display_name": "Stock Price",
            "documentation": "https://docs.langflow.org/components-helpers",
            "edited": true,
            "field_order": [
              "symbol"
            ],
            "frozen": false,
            "icon": "DollarSign",
            "last_updated": "2025-12-02T07:03:28.363Z",
            "legacy": false,
            "lf_version": "1.6.9",
            "metadata": {},
            "minimized": false,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Toolset",
                "group_outputs": false,
                "hidden": null,
                "method": "to_toolkit",
                "name": "component_as_tool",
                "options": null,
                "required_inputs": null,
                "selected": "Tool",
                "tool_mode": true,
                "types": [
                  "Tool"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_type": "Component",
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "import requests\r\nfrom langflow.custom.custom_component.component import Component\r\nfrom langflow.inputs.inputs import MessageTextInput\r\nfrom langflow.io import Output\r\nfrom langflow.schema.data import Data\r\n\r\n\r\nclass StockPriceComponent(Component):\r\n    display_name = \"Stock Price\"\r\n    description = \"Get current stock price and basic information using Yahoo Finance.\"\r\n    documentation: str = \"https://docs.langflow.org/components-helpers\"\r\n    icon = \"DollarSign\"\r\n    \r\n    inputs = [\r\n        MessageTextInput(\r\n            name=\"symbol\",\r\n            display_name=\"Stock Symbol\",\r\n            info=\"Stock ticker symbol (e.g., 'AAPL', 'MSFT', 'GOOGL', 'TSLA')\",\r\n            tool_mode=True,\r\n        ),\r\n    ]\r\n    \r\n    outputs = [\r\n        Output(display_name=\"Data\", name=\"result\", method=\"get_stock_price\"),\r\n    ]\r\n    \r\n    def get_stock_price(self) -> Data:\r\n        \"\"\"Get stock price from Yahoo Finance API.\"\"\"\r\n        try:\r\n            # Clean up the symbol\r\n            symbol = self.symbol.strip().upper()\r\n            \r\n            # Yahoo Finance API endpoint\r\n            url = f\"https://query1.finance.yahoo.com/v8/finance/chart/{symbol}\"\r\n            \r\n            headers = {\r\n                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'\r\n            }\r\n            \r\n            response = requests.get(url, headers=headers, timeout=10)\r\n            response.raise_for_status()\r\n            \r\n            data = response.json()\r\n            \r\n            # Extract data from response\r\n            if 'chart' in data and 'result' in data['chart'] and data['chart']['result']:\r\n                result = data['chart']['result'][0]\r\n                meta = result['meta']\r\n                \r\n                current_price = meta.get('regularMarketPrice')\r\n                previous_close = meta.get('previousClose')\r\n                currency = meta.get('currency', 'USD')\r\n                market_state = meta.get('marketState', 'UNKNOWN')\r\n                \r\n                # Calculate change\r\n                if current_price and previous_close:\r\n                    change = current_price - previous_close\r\n                    change_percent = (change / previous_close) * 100\r\n                else:\r\n                    change = None\r\n                    change_percent = None\r\n                \r\n                # Format result with source information\r\n                result_text = f\"Symbol: {symbol}\\n\"\r\n                result_text += f\"Price: {current_price:.2f} {currency}\\n\"\r\n                \r\n                if change is not None:\r\n                    change_sign = \"+\" if change >= 0 else \"\"\r\n                    result_text += f\"Change: {change_sign}{change:.2f} ({change_sign}{change_percent:.2f}%)\\n\"\r\n                \r\n                result_text += f\"Previous Close: {previous_close:.2f} {currency}\\n\"\r\n                result_text += f\"Market State: {market_state}\\n\"\r\n                result_text += f\"Source: Yahoo Finance\\n\"\r\n                result_text += f\"API: https://query1.finance.yahoo.com/v8/finance/chart/{symbol}\"\r\n                \r\n                self.log(f\"Stock price for {symbol}: {current_price} {currency}\")\r\n                self.status = f\"{symbol}: {current_price:.2f} {currency}\"\r\n                \r\n                return Data(data={\r\n                    \"symbol\": symbol,\r\n                    \"price\": current_price,\r\n                    \"currency\": currency,\r\n                    \"change\": change,\r\n                    \"change_percent\": change_percent,\r\n                    \"previous_close\": previous_close,\r\n                    \"market_state\": market_state,\r\n                    \"formatted_text\": result_text,\r\n                    \"source\": \"Yahoo Finance\",\r\n                    \"source_url\": f\"https://finance.yahoo.com/quote/{symbol}\",\r\n                    \"api_endpoint\": f\"https://query1.finance.yahoo.com/v8/finance/chart/{symbol}\"\r\n                })\r\n            else:\r\n                error_message = f\"No data found for symbol: {symbol}\"\r\n                self.status = error_message\r\n                return Data(data={\r\n                    \"error\": error_message, \r\n                    \"input\": symbol,\r\n                    \"source\": \"Yahoo Finance\"\r\n                })\r\n                \r\n        except requests.exceptions.Timeout:\r\n            error_message = f\"Request timeout for symbol: {symbol}\"\r\n            self.status = error_message\r\n            return Data(data={\r\n                \"error\": error_message, \r\n                \"input\": symbol,\r\n                \"source\": \"Yahoo Finance\"\r\n            })\r\n        except requests.exceptions.RequestException as e:\r\n            error_message = f\"Network error: {str(e)}\"\r\n            self.status = error_message\r\n            return Data(data={\r\n                \"error\": error_message, \r\n                \"input\": symbol,\r\n                \"source\": \"Yahoo Finance\"\r\n            })\r\n        except (KeyError, ValueError, TypeError) as e:\r\n            error_message = f\"Error parsing data for {symbol}: {str(e)}\"\r\n            self.status = error_message\r\n            return Data(data={\r\n                \"error\": error_message, \r\n                \"input\": symbol,\r\n                \"source\": \"Yahoo Finance\"\r\n            })\r\n    \r\n    def build(self):\r\n        \"\"\"Return the main function.\"\"\"\r\n        return self.get_stock_price"
              },
              "symbol": {
                "_input_type": "MessageTextInput",
                "advanced": false,
                "display_name": "Stock Symbol",
                "dynamic": false,
                "info": "Stock ticker symbol (e.g., 'AAPL', 'MSFT', 'GOOGL', 'TSLA')",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "symbol",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": true,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              },
              "tools_metadata": {
                "_input_type": "ToolsInput",
                "advanced": false,
                "display_name": "Actions",
                "dynamic": false,
                "info": "Modify tool names and descriptions to help agents understand when to use each tool.",
                "is_list": true,
                "list_add_label": "Add More",
                "name": "tools_metadata",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "tools",
                "value": [
                  {
                    "args": {
                      "symbol": {
                        "default": "",
                        "description": "Stock ticker symbol (e.g., 'AAPL', 'MSFT', 'GOOGL', 'TSLA')",
                        "title": "Symbol",
                        "type": "string"
                      }
                    },
                    "description": "Get current stock price and basic information using Yahoo Finance.",
                    "display_description": "Get current stock price and basic information using Yahoo Finance.",
                    "display_name": "get_stock_price",
                    "name": "get_stock_price",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "get_stock_price"
                    ]
                  }
                ]
              }
            },
            "tool_mode": true
          },
          "showNode": true,
          "type": "StockPriceComponent"
        },
        "dragging": false,
        "id": "CustomComponent-Q08ZY",
        "measured": {
          "height": 217,
          "width": 320
        },
        "position": {
          "x": 1884.0153290268129,
          "y": -343.25273200395605
        },
        "selected": false,
        "type": "genericNode"
      },
      {
        "data": {
          "id": "CustomComponent-Hn5kB",
          "node": {
            "base_classes": [
              "Data"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "REQUIRED for currency conversion. Provides real-time exchange rates from ExchangeRate-API.com. Use this tool whenever user asks about currency conversion, exchange rates, or comparing currency values. Returns accurate conversion with source attribution.",
            "display_name": "Currency Converter",
            "documentation": "https://docs.langflow.org/components-helpers",
            "edited": true,
            "field_order": [
              "amount",
              "from_currency",
              "to_currency",
              "custom_query"
            ],
            "frozen": false,
            "icon": "Banknote",
            "last_updated": "2025-12-02T07:03:28.364Z",
            "legacy": false,
            "lf_version": "1.6.9",
            "metadata": {},
            "minimized": false,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Toolset",
                "group_outputs": false,
                "hidden": null,
                "method": "to_toolkit",
                "name": "component_as_tool",
                "options": null,
                "required_inputs": null,
                "selected": "Tool",
                "tool_mode": true,
                "types": [
                  "Tool"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_type": "Component",
              "amount": {
                "_input_type": "FloatInput",
                "advanced": false,
                "display_name": "Amount",
                "dynamic": false,
                "info": "Amount to convert",
                "list": false,
                "list_add_label": "Add More",
                "name": "amount",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": true,
                "trace_as_metadata": true,
                "type": "float",
                "value": 1
              },
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "import requests\r\nfrom datetime import datetime\r\nfrom langflow.custom.custom_component.component import Component\r\nfrom langflow.inputs.inputs import MessageTextInput, DropdownInput, FloatInput\r\nfrom langflow.io import Output\r\nfrom langflow.schema.data import Data\r\n\r\n\r\nclass CurrencyConverterComponent(Component):\r\n    display_name = \"Currency Converter\"\r\n    description = \"REQUIRED for currency conversion. Provides real-time exchange rates from ExchangeRate-API.com. Use this tool whenever user asks about currency conversion, exchange rates, or comparing currency values. Returns accurate conversion with source attribution.\"\r\n    documentation: str = \"https://docs.langflow.org/components-helpers\"\r\n    icon = \"Banknote\"\r\n    \r\n    # Nejpoužívanější měny\r\n    POPULAR_CURRENCIES = [\r\n        \"USD\", \"EUR\", \"CZK\", \"GBP\", \"JPY\", \"CHF\", \"CAD\", \"AUD\", \r\n        \"CNY\", \"INR\", \"PLN\", \"SEK\", \"NOK\", \"DKK\", \"HUF\", \"RON\"\r\n    ]\r\n    \r\n    inputs = [\r\n        FloatInput(\r\n            name=\"amount\",\r\n            display_name=\"Amount\",\r\n            info=\"Amount to convert\",\r\n            value=1.0,\r\n            tool_mode=True,\r\n        ),\r\n        DropdownInput(\r\n            name=\"from_currency\",\r\n            display_name=\"From Currency\",\r\n            options=POPULAR_CURRENCIES,\r\n            value=\"USD\",\r\n            info=\"Source currency code (e.g., USD, EUR, CZK)\",\r\n        ),\r\n        DropdownInput(\r\n            name=\"to_currency\",\r\n            display_name=\"To Currency\",\r\n            options=POPULAR_CURRENCIES,\r\n            value=\"CZK\",\r\n            info=\"Target currency code (e.g., USD, EUR, CZK)\",\r\n        ),\r\n        MessageTextInput(\r\n            name=\"custom_query\",\r\n            display_name=\"Natural Language Query\",\r\n            info=\"Optional: Enter query like '100 USD to CZK' (overrides other inputs)\",\r\n            tool_mode=True,\r\n            advanced=True,\r\n        ),\r\n    ]\r\n    \r\n    outputs = [\r\n        Output(display_name=\"Data\", name=\"result\", method=\"convert_currency\"),\r\n    ]\r\n    \r\n    def parse_natural_query(self, query: str) -> tuple[float, str, str] | None:\r\n        \"\"\"Parse natural language query like '100 USD to CZK'.\"\"\"\r\n        try:\r\n            query = query.strip().upper()\r\n            \r\n            # Patterns: \"100 USD to CZK\", \"convert 50 EUR to USD\"\r\n            parts = query.replace(\"CONVERT\", \"\").strip().split()\r\n            \r\n            # Find amount\r\n            amount = None\r\n            from_curr = None\r\n            to_curr = None\r\n            \r\n            for i, part in enumerate(parts):\r\n                # Try to find amount (number)\r\n                if amount is None:\r\n                    try:\r\n                        amount = float(part.replace(\",\", \".\"))\r\n                        continue\r\n                    except ValueError:\r\n                        pass\r\n                \r\n                # Find currency codes (3 letter codes)\r\n                if len(part) == 3 and part.isalpha():\r\n                    if from_curr is None:\r\n                        from_curr = part\r\n                    elif to_curr is None and part != from_curr:\r\n                        to_curr = part\r\n            \r\n            if amount and from_curr and to_curr:\r\n                return amount, from_curr, to_curr\r\n            \r\n            return None\r\n            \r\n        except Exception as e:\r\n            self.log(f\"Error parsing query: {e}\")\r\n            return None\r\n    \r\n    def get_exchange_rate(self, from_curr: str, to_curr: str) -> dict | None:\r\n        \"\"\"Get exchange rate from exchangerate-api.com (free tier, no API key needed).\"\"\"\r\n        try:\r\n            # Using exchangerate-api.com free API\r\n            url = f\"https://api.exchangerate-api.com/v4/latest/{from_curr}\"\r\n            \r\n            response = requests.get(url, timeout=10)\r\n            response.raise_for_status()\r\n            \r\n            data = response.json()\r\n            \r\n            if 'rates' in data and to_curr in data['rates']:\r\n                return {\r\n                    'rate': data['rates'][to_curr],\r\n                    'base': from_curr,\r\n                    'date': data.get('date', datetime.now().strftime('%Y-%m-%d'))\r\n                }\r\n            \r\n            return None\r\n            \r\n        except Exception as e:\r\n            self.log(f\"Error fetching exchange rate: {e}\")\r\n            return None\r\n    \r\n    def convert_currency(self) -> Data:\r\n        \"\"\"Convert currency amount.\"\"\"\r\n        try:\r\n            # Check if natural language query is provided\r\n            if self.custom_query and self.custom_query.strip():\r\n                parsed = self.parse_natural_query(self.custom_query)\r\n                if parsed:\r\n                    amount, from_curr, to_curr = parsed\r\n                    self.log(f\"Parsed query: {amount} {from_curr} to {to_curr}\")\r\n                else:\r\n                    return Data(data={\r\n                        \"error\": \"Could not parse query. Use format: '100 USD to CZK'\",\r\n                        \"input\": self.custom_query\r\n                    })\r\n            else:\r\n                # Use dropdown inputs\r\n                amount = self.amount\r\n                from_curr = self.from_currency.upper()\r\n                to_curr = self.to_currency.upper()\r\n            \r\n            # Validate inputs\r\n            if amount <= 0:\r\n                return Data(data={\"error\": \"Amount must be positive\", \"input\": amount})\r\n            \r\n            if from_curr == to_curr:\r\n                result_text = f\"{amount:.2f} {from_curr} = {amount:.2f} {to_curr} (same currency)\\n\"\r\n                result_text += f\"Source: Same currency, no conversion needed\"\r\n                self.status = result_text\r\n                return Data(data={\r\n                    \"amount\": amount,\r\n                    \"from_currency\": from_curr,\r\n                    \"to_currency\": to_curr,\r\n                    \"result\": amount,\r\n                    \"rate\": 1.0,\r\n                    \"formatted_text\": result_text,\r\n                    \"source\": \"No conversion needed\",\r\n                    \"source_url\": None\r\n                })\r\n            \r\n            # Get exchange rate\r\n            rate_data = self.get_exchange_rate(from_curr, to_curr)\r\n            \r\n            if not rate_data:\r\n                error_message = f\"Could not fetch exchange rate for {from_curr} to {to_curr}\"\r\n                self.status = error_message\r\n                return Data(data={\"error\": error_message})\r\n            \r\n            # Calculate conversion\r\n            rate = rate_data['rate']\r\n            result = amount * rate\r\n            \r\n            # Format result with source information\r\n            result_text = f\"{amount:.2f} {from_curr} = {result:.2f} {to_curr}\\n\"\r\n            result_text += f\"Exchange rate: 1 {from_curr} = {rate:.4f} {to_curr}\\n\"\r\n            result_text += f\"Date: {rate_data['date']}\\n\"\r\n            result_text += f\"Source: ExchangeRate-API.com\\n\"\r\n            result_text += f\"API: https://api.exchangerate-api.com/v4/latest/{from_curr}\"\r\n            \r\n            self.log(f\"Converted {amount} {from_curr} to {result:.2f} {to_curr}\")\r\n            self.status = f\"{amount:.2f} {from_curr} → {result:.2f} {to_curr}\"\r\n            \r\n            return Data(data={\r\n                \"amount\": amount,\r\n                \"from_currency\": from_curr,\r\n                \"to_currency\": to_curr,\r\n                \"result\": round(result, 2),\r\n                \"exchange_rate\": rate,\r\n                \"date\": rate_data['date'],\r\n                \"formatted_text\": result_text,\r\n                \"source\": \"ExchangeRate-API.com\",\r\n                \"source_url\": f\"https://api.exchangerate-api.com/v4/latest/{from_curr}\",\r\n                \"api_endpoint\": f\"https://api.exchangerate-api.com/v4/latest/{from_curr}\"\r\n            })\r\n            \r\n        except requests.exceptions.Timeout:\r\n            error_message = \"Request timeout - exchange rate service unavailable\"\r\n            self.status = error_message\r\n            return Data(data={\"error\": error_message})\r\n        except requests.exceptions.RequestException as e:\r\n            error_message = f\"Network error: {str(e)}\"\r\n            self.status = error_message\r\n            return Data(data={\"error\": error_message})\r\n        except Exception as e:\r\n            error_message = f\"Conversion error: {str(e)}\"\r\n            self.status = error_message\r\n            return Data(data={\"error\": error_message})\r\n    \r\n    def build(self):\r\n        \"\"\"Return the main function.\"\"\"\r\n        return self.convert_currency"
              },
              "custom_query": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Natural Language Query",
                "dynamic": false,
                "info": "Optional: Enter query like '100 USD to CZK' (overrides other inputs)",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "custom_query",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": true,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              },
              "from_currency": {
                "_input_type": "DropdownInput",
                "advanced": false,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "From Currency",
                "dynamic": false,
                "external_options": {},
                "info": "Source currency code (e.g., USD, EUR, CZK)",
                "load_from_db": false,
                "name": "from_currency",
                "options": [
                  "USD",
                  "EUR",
                  "CZK",
                  "GBP",
                  "JPY",
                  "CHF",
                  "CAD",
                  "AUD",
                  "CNY",
                  "INR",
                  "PLN",
                  "SEK",
                  "NOK",
                  "DKK",
                  "HUF",
                  "RON"
                ],
                "options_metadata": [],
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "str",
                "value": "USD"
              },
              "to_currency": {
                "_input_type": "DropdownInput",
                "advanced": false,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "To Currency",
                "dynamic": false,
                "external_options": {},
                "info": "Target currency code (e.g., USD, EUR, CZK)",
                "load_from_db": false,
                "name": "to_currency",
                "options": [
                  "USD",
                  "EUR",
                  "CZK",
                  "GBP",
                  "JPY",
                  "CHF",
                  "CAD",
                  "AUD",
                  "CNY",
                  "INR",
                  "PLN",
                  "SEK",
                  "NOK",
                  "DKK",
                  "HUF",
                  "RON"
                ],
                "options_metadata": [],
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "str",
                "value": "CZK"
              },
              "tools_metadata": {
                "_input_type": "ToolsInput",
                "advanced": false,
                "display_name": "Actions",
                "dynamic": false,
                "info": "Modify tool names and descriptions to help agents understand when to use each tool.",
                "is_list": true,
                "list_add_label": "Add More",
                "name": "tools_metadata",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "tools",
                "value": [
                  {
                    "args": {
                      "amount": {
                        "default": 1,
                        "description": "Amount to convert",
                        "title": "Amount",
                        "type": "number"
                      },
                      "custom_query": {
                        "default": "",
                        "description": "Optional: Enter query like '100 USD to CZK' (overrides other inputs)",
                        "title": "Custom Query",
                        "type": "string"
                      }
                    },
                    "description": "REQUIRED for currency conversion. Provides real-time exchange rates from ExchangeRate-API.com. Use this tool whenever user asks about currency conversion, exchange rates, or comparing currency values. Returns accurate conversion with source attribution.",
                    "display_description": "REQUIRED for currency conversion. Provides real-time exchange rates from ExchangeRate-API.com. Use this tool whenever user asks about currency conversion, exchange rates, or comparing currency values. Returns accurate conversion with source attribution.",
                    "display_name": "convert_currency",
                    "name": "convert_currency",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "convert_currency"
                    ]
                  }
                ]
              }
            },
            "tool_mode": true
          },
          "showNode": true,
          "type": "CurrencyConverterComponent"
        },
        "dragging": false,
        "id": "CustomComponent-Hn5kB",
        "measured": {
          "height": 446,
          "width": 320
        },
        "position": {
          "x": 1884.2223625255851,
          "y": -801.1378839056259
        },
        "selected": false,
        "type": "genericNode"
      },
      {
        "data": {
          "id": "CustomComponent-J5Vsv",
          "node": {
            "base_classes": [
              "Data"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Scrapes article listings from iDNES.cz archives. Extracts title, link, published time and updated time.",
            "display_name": "Web Scraper iDNES Archive",
            "documentation": "https://docs.langflow.org/components-helpers",
            "edited": true,
            "field_order": [
              "url",
              "max_articles"
            ],
            "frozen": false,
            "icon": "Globe",
            "last_updated": "2025-12-02T07:03:28.364Z",
            "legacy": false,
            "lf_version": "1.6.9",
            "metadata": {},
            "minimized": false,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Toolset",
                "group_outputs": false,
                "hidden": null,
                "method": "to_toolkit",
                "name": "component_as_tool",
                "options": null,
                "required_inputs": null,
                "selected": "Tool",
                "tool_mode": true,
                "types": [
                  "Tool"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_type": "Component",
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "import re\r\nimport requests\r\nfrom bs4 import BeautifulSoup\r\nfrom datetime import datetime\r\nfrom urllib.parse import urljoin, urlparse\r\nfrom langflow.custom.custom_component.component import Component\r\nfrom langflow.inputs.inputs import MessageTextInput, IntInput\r\nfrom langflow.io import Output\r\nfrom langflow.schema.data import Data\r\n\r\nclass WebScraperIDNESComponent(Component):\r\n    display_name = \"Web Scraper iDNES Archive\"\r\n    description = (\r\n        \"Scrapes article listings from iDNES.cz archives. \"\r\n        \"Extracts title, link, published time and updated time.\"\r\n    )\r\n    documentation: str = \"https://docs.langflow.org/components-helpers\"\r\n    icon = \"Globe\"\r\n\r\n    inputs = [\r\n        MessageTextInput(\r\n            name=\"url\",\r\n            display_name=\"Archive URL\",\r\n            info=\"URL archivu iDNES (např. https://www.idnes.cz)\",\r\n            tool_mode=True,\r\n        ),\r\n        IntInput(\r\n            name=\"max_articles\",\r\n            display_name=\"Max Articles\",\r\n            info=\"Maximum number of articles to return (1-50)\",\r\n            value=10,\r\n            advanced=True,\r\n        ),\r\n    ]\r\n\r\n    outputs = [\r\n        Output(display_name=\"Data\", name=\"result\", method=\"scrape_website\"),\r\n    ]\r\n\r\n    def clean_text(self, text: str) -> str:\r\n        if not text:\r\n            return \"\"\r\n        return \" \".join(text.split()).strip()\r\n\r\n    def parse_czech_datetime(self, text: str) -> str:\r\n        if not text:\r\n            return \"\"\r\n        months = {\r\n            \"ledna\": 1, \"února\": 2, \"března\": 3, \"dubna\": 4,\r\n            \"května\": 5, \"června\": 6, \"července\": 7, \"srpna\": 8,\r\n            \"září\": 9, \"října\": 10, \"listopadu\": 11, \"prosince\": 12,\r\n        }\r\n        text_low = self.clean_text(text).lower()\r\n        m = re.search(\r\n            r\"(\\d{1,2})\\.\\s+([a-záéíóúůýěščřž]+)\\s+(\\d{4})\\s+(\\d{1,2}):(\\d{2})\",\r\n            text_low\r\n        )\r\n        if not m:\r\n            return \"\"\r\n        day = int(m.group(1))\r\n        month_name = m.group(2)\r\n        year = int(m.group(3))\r\n        hour = int(m.group(4))\r\n        minute = int(m.group(5))\r\n        month = months.get(month_name)\r\n        if not month:\r\n            return \"\"\r\n        try:\r\n            dt = datetime(year, month, day, hour, minute)\r\n            return dt.isoformat()\r\n        except ValueError:\r\n            return \"\"\r\n\r\n    def extract_times(self, element) -> dict:\r\n        result = {\r\n            \"published_text\": \"\",\r\n            \"updated_text\": \"\",\r\n            \"published_iso\": \"\",\r\n            \"updated_iso\": \"\",\r\n        }\r\n        art_info = element.select_one(\".art-info\")\r\n        if not art_info:\r\n            return result\r\n        time_span = art_info.find(\"span\", class_=\"time\")\r\n        if not time_span:\r\n            return result\r\n\r\n        # zveřejněno – text před vnořeným span\r\n        direct = \"\".join(time_span.find_all(string=True, recursive=False))\r\n        published_text = self.clean_text(direct).rstrip(\",\")\r\n        result[\"published_text\"] = published_text\r\n        # ISO pro zveřejněno\r\n        result[\"published_iso\"] = time_span.get(\"datetime\") or self.parse_czech_datetime(published_text)\r\n\r\n        # aktualizováno\r\n        aktual = time_span.find(\"span\", class_=\"aktual\")\r\n        if aktual:\r\n            updated_text = self.clean_text(aktual.get_text())\r\n            result[\"updated_text\"] = updated_text\r\n            # pokus o vytvoření ISO z textu „aktualizováno 26. 11.“\r\n            m = re.search(r\"(\\d{1,2}\\.\\s*\\d{1,2}\\.)\", updated_text)\r\n            if m and result[\"published_iso\"]:\r\n                try:\r\n                    base = datetime.fromisoformat(result[\"published_iso\"])\r\n                    # datum aktualizace bez času – nastavíme na stejný čas jako zveřejnění\r\n                    upd_day_month = m.group(1)\r\n                    # Rozdělit „26. 11.“ -> den=26, měsíc=11\r\n                    parts = upd_day_month.replace(\" \", \"\").split(\".\")\r\n                    day = int(parts[0])\r\n                    month = int(parts[1])\r\n                    upd_dt = base.replace(day=day, month=month)\r\n                    result[\"updated_iso\"] = upd_dt.isoformat()\r\n                except Exception:\r\n                    pass\r\n        # fallback: pokud updated_iso zatím není, použij datetime atribut\r\n        if not result[\"updated_iso\"]:\r\n            dt_attr = time_span.get(\"datetime\")\r\n            if dt_attr:\r\n                result[\"updated_iso\"] = dt_attr\r\n\r\n        return result\r\n\r\n    def scrape_archive(self, soup: BeautifulSoup, base_url: str, max_articles: int) -> list:\r\n        articles = []\r\n        base_domain = urlparse(base_url).netloc\r\n        elements = soup.select(\"div.art\")\r\n        if not elements:\r\n            elements = soup.select(\".art\")\r\n        for elem in elements:\r\n            if len(articles) >= max_articles:\r\n                break\r\n            link_elem = elem.find(\"a\", href=True, class_=\"art-link\")\r\n            if not link_elem:\r\n                continue\r\n            title_elem = link_elem.find(\"h3\")\r\n            if title_elem:\r\n                title = self.clean_text(title_elem.get_text())\r\n            else:\r\n                title = self.clean_text(link_elem.get_text())\r\n            if not title or len(title) < 10:\r\n                continue\r\n            href = link_elem.get(\"href\", \"\")\r\n            link = urljoin(base_url, href)\r\n            if base_domain not in urlparse(link).netloc:\r\n                continue\r\n            # times\r\n            times = self.extract_times(elem)\r\n            article = {\r\n                \"title\": title[:300],\r\n                \"link\": link,\r\n                \"published\": times[\"published_text\"],\r\n                \"updated\": times[\"updated_text\"],\r\n                \"published_iso\": times[\"published_iso\"],\r\n                \"updated_iso\": times[\"updated_iso\"],\r\n                \"time\": times[\"published_text\"] or times[\"published_iso\"] or \"\",\r\n            }\r\n            articles.append(article)\r\n        # řazení podle published_iso\r\n        with_iso = [a for a in articles if a.get(\"published_iso\")]\r\n        without_iso = [a for a in articles if not a.get(\"published_iso\")]\r\n        with_iso.sort(key=lambda a: a[\"published_iso\"], reverse=True)\r\n        sorted_articles = with_iso + without_iso\r\n        return sorted_articles[:max_articles]\r\n\r\n    def scrape_website(self) -> Data:\r\n        try:\r\n            url = self.url.strip()\r\n            max_articles = min(max(self.max_articles, 1), 50)\r\n            if not url.startswith((\"http://\",\"https://\")):\r\n                url = \"https://\" + url\r\n\r\n            if \"idnes.cz\" not in url.lower():\r\n                error = \"URL není na doméně iDNES.cz – tento komponent je optimalizovaný pro iDNES archivy.\"\r\n                self.status = error\r\n                return Data(data={\"error\": error, \"url\": url, \"source\": \"Web Scraper iDNES Tool\"})\r\n\r\n            self.log(f\"Scraping {url} for max {max_articles} articles\")\r\n\r\n            headers = {\r\n                \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64)\",\r\n                \"Accept-Language\": \"cs-CZ,cs;q=0.9,en;q=0.8\"\r\n            }\r\n            response = requests.get(url, headers=headers, timeout=15)\r\n            response.raise_for_status()\r\n            response.encoding = \"utf-8\"\r\n\r\n            soup = BeautifulSoup(response.text, \"html.parser\")\r\n            page_title_elem = soup.find(\"title\")\r\n            page_title = self.clean_text(page_title_elem.get_text()) if page_title_elem else urlparse(url).netloc\r\n\r\n            articles = self.scrape_archive(soup, url, max_articles)\r\n\r\n            if not articles:\r\n                return Data(data={\"error\": \"Nebyl nalezen žádný článek.\", \"url\": url, \"source\": \"Web Scraper iDNES Tool\", \"scraped_at\": datetime.now().isoformat()})\r\n\r\n            result_text = f\"Shrnutí článků ze stránky {urlparse(url).netloc}\\n\"\r\n            result_text += f\"(stav k {datetime.now().strftime('%d. %m. %Y, %H:%M')})\\n\\n\"\r\n            for art in articles:\r\n                pub = art.get(\"published\") or \"\"\r\n                upd = art.get(\"updated\") or \"\"\r\n                if pub or upd:\r\n                    if pub:\r\n                        result_text += pub\r\n                    if upd:\r\n                        result_text += f\" (aktualizováno {upd})\"\r\n                    result_text += \" - \"\r\n                result_text += f\"{art['title']}\\n{art['link']}\\n\\n\"\r\n            result_text += f\"\\nZdroj: {url}\\nZískáno: Web Scraper iDNES Tool dne {datetime.now().strftime('%d. %m. %Y')}\"\r\n\r\n            self.status = f\"Nalezeno {len(articles)} článků\"\r\n            self.log(f\"Successfully scraped {len(articles)} articles from {url}\")\r\n\r\n            return Data(data={\r\n                \"page_title\": page_title,\r\n                \"url\": url,\r\n                \"articles\": articles,\r\n                \"article_count\": len(articles),\r\n                \"formatted_text\": result_text,\r\n                \"source\": \"Web Scraper iDNES Tool\",\r\n                \"scraped_at\": datetime.now().isoformat(),\r\n                \"tool_used\": \"WebScraperIDNESComponent\"\r\n            })\r\n\r\n        except requests.exceptions.Timeout:\r\n            error = f\"Časový limit vypršel pro {self.url}\"\r\n            self.status = error\r\n            return Data(data={\"error\": error, \"url\": self.url, \"source\": \"Web Scraper iDNES Tool\"})\r\n        except requests.exceptions.RequestException as e:\r\n            error = f\"Chyba sítě: {str(e)}\"\r\n            self.status = error\r\n            return Data(data={\"error\": error, \"url\": self.url, \"source\": \"Web Scraper iDNES Tool\"})\r\n        except Exception as e:\r\n            error = f\"Chyba při scrapování: {str(e)}\"\r\n            self.status = error\r\n            return Data(data={\"error\": error, \"url\": self.url, \"source\": \"Web Scraper iDNES Tool\"})\r\n    \r\n    def build(self):\r\n        return self.scrape_website\r\n"
              },
              "max_articles": {
                "_input_type": "IntInput",
                "advanced": true,
                "display_name": "Max Articles",
                "dynamic": false,
                "info": "Maximum number of articles to return (1-50)",
                "list": false,
                "list_add_label": "Add More",
                "name": "max_articles",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "int",
                "value": 10
              },
              "tools_metadata": {
                "_input_type": "ToolsInput",
                "advanced": false,
                "display_name": "Actions",
                "dynamic": false,
                "info": "Modify tool names and descriptions to help agents understand when to use each tool.",
                "is_list": true,
                "list_add_label": "Add More",
                "name": "tools_metadata",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "type": "tools",
                "value": [
                  {
                    "args": {
                      "url": {
                        "default": "",
                        "description": "URL archivu iDNES (např. https://www.idnes.cz)",
                        "title": "Url",
                        "type": "string"
                      }
                    },
                    "description": "Scrapes article listings from iDNES.cz archives. Extracts title, link, published time and updated time.",
                    "display_description": "Scrapes article listings from iDNES.cz archives. Extracts title, link, published time and updated time.",
                    "display_name": "scrape_website",
                    "name": "scrape_website",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "scrape_website"
                    ]
                  }
                ]
              },
              "url": {
                "_input_type": "MessageTextInput",
                "advanced": false,
                "display_name": "Archive URL",
                "dynamic": false,
                "info": "URL archivu iDNES (např. https://www.idnes.cz)",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "url",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": true,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "type": "str",
                "value": ""
              }
            },
            "tool_mode": true
          },
          "showNode": true,
          "type": "WebScraperIDNESComponent"
        },
        "dragging": false,
        "id": "CustomComponent-J5Vsv",
        "measured": {
          "height": 217,
          "width": 320
        },
        "position": {
          "x": 1884.2734114722339,
          "y": -1048.593474289791
        },
        "selected": false,
        "type": "genericNode"
      }
    ],
    "viewport": {
      "x": -555.1063236176435,
      "y": 188.75336212122204,
      "zoom": 0.53732232320034
    }
  },
  "description": "Akcie, Kurzy, Počasí",
  "endpoint_name": null,
  "id": "ddecf499-94af-4908-9af4-b9f1331a0d49",
  "is_component": false,
  "last_tested_version": "1.6.9",
  "name": "Lesson 04 Chatbot",
  "tags": [
    "chatbots",
    "openai",
    "assistants"
  ]
}